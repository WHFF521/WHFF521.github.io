<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>AiRomance</title>
  <icon>https://blog.whff521.xyz/images/101.ico</icon>
  <subtitle>çˆ±è£¸æ¼«ä¸‰ä¸‰</subtitle>
  <link href="https://blog.whff521.xyz/atom.xml" rel="self"/>
  <link href="https://pubsubhubbub.appspot.com/" rel="hub"/>
  <link href="https://blog.whff521.xyz/"/>
  <updated>2025-07-22T07:06:20.831Z</updated>
  <id>https://blog.whff521.xyz/</id>
  
  <author>
    <name>AiRomance</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Kaggle ç¦»çº¿ä½¿ç”¨YOLOv5â€”â€”Global Wheat Detection</title>
    <link href="https://blog.whff521.xyz/2025/07/22/Kaggle-%E7%A6%BB%E7%BA%BF%E4%BD%BF%E7%94%A8YOLOv5%E2%80%94%E2%80%94Global-Wheat-Detection/"/>
    <id>https://blog.whff521.xyz/2025/07/22/Kaggle-%E7%A6%BB%E7%BA%BF%E4%BD%BF%E7%94%A8YOLOv5%E2%80%94%E2%80%94Global-Wheat-Detection/</id>
    <published>2025-07-22T05:40:14.000Z</published>
    <updated>2025-07-22T07:06:20.831Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Kaggle-ç¦»çº¿ä½¿ç”¨YOLOv5â€”â€”Global-Wheat-Detection"><a href="#Kaggle-ç¦»çº¿ä½¿ç”¨YOLOv5â€”â€”Global-Wheat-Detection" class="headerlink" title="Kaggle ç¦»çº¿ä½¿ç”¨YOLOv5â€”â€”Global Wheat Detection"></a>Kaggle ç¦»çº¿ä½¿ç”¨YOLOv5â€”â€”Global Wheat Detection</h1><p>Kaggleä¸Šå¾ˆå¤šæ¯”èµ›éƒ½è¦æ±‚ä»£ç åœ¨ç¦»çº¿ï¼ˆofflineï¼‰çŠ¶æ€ä¸‹è¿è¡Œçš„ï¼Œè™½ç„¶notebookçš„è¿è¡Œç¯å¢ƒå·²ç»è‡ªå¸¦äº†å¾ˆå¤šæ·±åº¦å­¦ä¹ å’Œç¥ç»ç½‘ç»œçš„åŒ…ï¼Œä½†æ˜¯è¦è¿è¡ŒGitHubä¸Šä¸‹è½½çš„YOLOv5æ¨¡å‹è¿˜å·®ä¸€äº›åŒ…å’Œç¯å¢ƒéœ€æ±‚å¯¼è‡´ä¸èƒ½ç›´æ¥è¿è¡Œã€‚è€Œä¸”ç¦»çº¿çŠ¶æ€ä¸‹ä¹Ÿä¸å…è®¸ä½¿ç”¨<code>git</code>å‘½ä»¤å…‹éš†ä»“åº“ã€‚</p><p>é‚£æˆ‘ç›´æ¥ä¸Šä¼ æœ€ç»ˆ<code>submission.csv</code>ä¸å°±è¡Œäº†ï¼Ÿå¾ˆé—æ†¾ä¸è¡Œçš„ã€‚å› ä¸ºæœ€ç»ˆåˆ†æ•°ä¼šæ‰©å¤§æµ‹è¯•æ•°æ®é‡æ–°æµ‹è¯•ä½ ä»£ç è¿è¡Œçš„ç»“æœï¼Œè¿™å…¶å®ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¦offlineçš„åŸå› ï¼Œé˜²æ­¢æœ‰äººåˆ©ç”¨ç½‘ç»œå°†æ‰©å¤§çš„æ•°æ®é›†ä¼ å‡ºæ¥ä»¥è‡´äºä¸å…¬å¹³ã€‚</p><p>æˆ‘æœ¬æ¥æ˜¯æƒ³ç”¨<a href="https://www.kaggle.com/competitions/global-wheat-detection">Global Wheat Detection</a>ç»ƒä¹ ä¸€ä¸‹YOLOv5çš„ä½¿ç”¨ï¼Œä½†æ˜¯å› ä¸ºç¦»çº¿ç¯å¢ƒç¡®å®å›°æ‰°äº†æˆ‘å‡ å¤©çš„æ—¶é—´ã€‚æˆ‘å¯¹Kaggleçš„notebookåˆ°åº•æ˜¯æ€ä¹ˆè¿ä½œçš„å¹¶ä¸æ¸…æ¥šï¼Œè€Œä¸”ç½‘ä¸Šé²œæœ‰è¿™æ ·çš„æ•™ç¨‹ã€‚ç½‘ç»œä¸Šæœä¸åˆ°ç­”æ¡ˆåªæœ‰ä¸¤ç§æƒ…å†µï¼šä¸€æ˜¯è¿™çœŸçš„å¾ˆéš¾ï¼Œæ²¡æœ‰äººèƒ½åšå‡ºæ¥ï¼ˆæˆ‘çš„é—®é¢˜å½“ç„¶ä¸æ˜¯è¿™ç§æƒ…å†µï¼‰ï¼›<strong>äºŒæ˜¯ç­”æ¡ˆå¾ˆç®€å•ï¼Œä¸å€¼å¾—å‡ºæ•™ç¨‹ï¼ˆäº‹å®ç¡®å®æ˜¯è¿™æ ·ï¼‰</strong>ã€‚ä¸è¿‡è¿˜æ˜¯åœ¨æ­¤è®°å½•ä¸€ä¸‹æˆ‘æ˜¯æ€ä¹ˆå®ç°çš„å§</p><h2 id="Notebookç¯å¢ƒè¯´æ˜"><a href="#Notebookç¯å¢ƒè¯´æ˜" class="headerlink" title="Notebookç¯å¢ƒè¯´æ˜"></a>Notebookç¯å¢ƒè¯´æ˜</h2><p>Kaggleçš„Notebookå®é™…ä¸Šæ˜¯ä¸€ä¸ª<code>.ipynb</code>ç¼–è¾‘å™¨ï¼Œæ”¯æŒcodeå’Œmarkdownä¸¤ç§è¯­è¨€è¿›è¡Œç¼–å†™ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†æ®µç¼–å†™å’Œè¿è¡Œä»£ç ã€‚å› ä¸ºnotebookèƒ½æŒç»­ä¿æŒè¿è¡ŒçŠ¶æ€ï¼Œå¯ä»¥ä¸€å—ä¸€å—åœ°æ‰§è¡Œä»£ç ï¼Œä¸”å‰é¢çš„æ‰§è¡Œç»“æœå’Œå˜é‡ä¾ç„¶æœ‰æ•ˆã€‚</p><p>è®¾ç½®å¯ä»¥æ›´æ”¹è¿è¡Œæ˜¯å¦ä½¿ç”¨GPUï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ï¼Œè¦åœ¨ä»£ç è¿è¡Œä¹‹å‰å°±è¿›è¡Œé€‰æ‹©ï¼Œå› ä¸ºæ›´æ¢GPUä¸æ˜¯çƒ­åŠ è½½ï¼Œè€Œæ˜¯ç›´æ¥æ›´æ¢ä¸€ä¸ªæ–°çš„è¿è¡Œç¯å¢ƒï¼Œä¹‹å‰è¿è¡Œçš„ç¯å¢ƒä¼šä¸¢å¤±ã€‚</p><p>å³è¾¹<code>sidebar</code>ï¼ˆå¦‚æœæ²¡æœ‰åœ¨<code>view</code>é‡Œç‚¹å‡»<code>show sidebar</code>ï¼‰å¯ä»¥åŠ è½½æ•°æ®é›†ã€‚å¦‚æœä½ æ˜¯åœ¨æ¯”èµ›çš„<code>code</code>é¡µé¢ç‚¹å‡»çš„<code>new notebook</code>ï¼Œé‚£ä¹ˆå¯ä»¥çœ‹åˆ°<code>input</code>è‡ªåŠ¨åŠ è½½äº†è¿™åœºæ¯”èµ›çš„æ•°æ®é›†ã€‚</p><p>å¯ä»¥è‡ªè¡Œæ·»åŠ æ•°æ®åˆ°<code>input</code>é‡Œé¢ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼šä¸€æ˜¯ä»ç½‘ç«™å·²æœ‰çš„æ•°æ®è¿›è¡Œæ·»åŠ ï¼Œæ¯”å¦‚å…¶ä»–æ¯”èµ›çš„æ•°æ®é›†ï¼Œæˆ–è€…æ˜¯ä½ è‡ªå·±å…¶ä»–notebookä¸Šçš„äº§å‡ºæ–‡ä»¶ï¼ˆOutputï¼‰ï¼›äºŒæ˜¯ä»è‡ªå·±ç”µè„‘ä¸Šä¼ å‹ç¼©åŒ…æ–‡ä»¶ï¼Œä¸Šä¼ çš„æ—¶å€™ä¼šè¯¢é—®æ˜¯modelè¿˜æ˜¯datasetï¼Œå…¶å®è¿˜æ˜¯ç¬¬ä¸€ç§æ–¹å¼åŠ è½½æ•°æ®ï¼Œä½ ä¸Šä¼ çš„æ–‡ä»¶ä¼šå…ˆä¿å­˜åˆ°ç½‘ç«™ä¸Šï¼Œç„¶åå†åŠ è½½ã€‚ä½ ä¸Šä¼ çš„å‹ç¼©æ–‡ä»¶ä¼šè‡ªåŠ¨è§£å‹åˆ°å½“å‰ç¯å¢ƒçš„<code>input</code>ç›®å½•ä¸‹ã€‚</p><p>æ³¨æ„ï¼Œæ‰€æœ‰notebookéƒ½æœ‰ä¸¤ä¸ªè·¯å¾„å¯ä»¥ä½¿ç”¨ï¼Œä¸€æ˜¯<code>/kaggle/input/</code>,è¿™ä¸ªæ˜¯å­˜æ”¾æ‰€æœ‰å‡†å¤‡ä½¿ç”¨çš„æ–‡ä»¶çš„ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹åªè¯»ï¼Œä¸èƒ½æ›´æ”¹ï¼›äºŒæ˜¯<code>/kaggle/working/</code>ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹æ˜¯ä½ ä»£ç æ‰€æœ‰äº§å‡ºä¿å­˜æ–‡ä»¶çš„åœ°å€ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹æ²¡æœ‰åªè¯»çš„é™åˆ¶ï¼Œå¯ä»¥éšæ„æ›´æ”¹ï¼Œä½†æ˜¯æœ‰ä¸Šé™20GBçš„è¦æ±‚ã€‚åœ¨è¿è¡Œ<code>Save&amp;Run All(Commit)</code>ä¿å­˜è¿™ä¸ªç‰ˆæœ¬çš„Versionçš„æ—¶å€™ï¼ŒKaggleä¼šè‡ªåŠ¨ä»å¤´åˆ°å°¾è¿è¡Œä»£ç ï¼Œè€Œä¸”ä¿å­˜è¿™ä¸ªnotebookçš„<code>/kaggle/working/</code>ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚å½“ä½ åœ¨æ–°notebooké‡Œé¢ï¼Œå¯ä»¥æ·»åŠ è¿™ä¸ªnotebookçš„outputï¼Œä¼šä¿å­˜åœ¨æ–°notebookçš„<code>/kaggle/input/</code>çš„æ–‡ä»¶å¤¹ä¸‹ã€‚</p><p>å»ºè®®å…ˆå°†æ‰€æœ‰æ–‡ä»¶å¤åˆ¶åˆ°<code>working</code>æ–‡ä»¶å¤¹ä¸‹åœ¨è¿›è¡Œå…¶ä»–æ“ä½œï¼Œå¤„ç†æ•°æ®ä¼šæ¯”è¾ƒæ–¹ä¾¿ã€‚</p><h2 id="å®ç°æ–¹æ³•"><a href="#å®ç°æ–¹æ³•" class="headerlink" title="å®ç°æ–¹æ³•"></a>å®ç°æ–¹æ³•</h2><p>å› ä¸ºæ˜¯è¾¹è¯•é”™è¾¹å®Œæˆçš„ï¼Œæ‰€ä»¥æ­¥éª¤æœ‰äº›å†—ä½™ã€‚</p><p>æˆ‘ä¸€å…±åˆ›å»ºäº†ä¸‰ä¸ªnotebookå’Œä¸€ä¸ªdatasetã€‚notebookåˆ†åˆ«æ˜¯<code>YOLOv5&amp;Dependences</code>,<code>WheatDetectOffineTrain</code>å’Œ<code>WheatDetectOfflineDetect</code>ã€‚ä¸€ä¸ªæ•°æ®é›†æ˜¯<code>ArialTTF</code>,å…¶å®å°±æ˜¯Arialå­—ä½“æ–‡ä»¶ã€‚</p><p>è¿™é‡Œå¼ºè°ƒä¸€ä¸‹ï¼Œæ¨¡å‹çš„è®­ç»ƒå’Œæ£€æµ‹å»ºè®®åˆ†æˆä¸¤ä¸ªnotebookæ¥å†™ï¼Œå› ä¸ºæäº¤ä¹‹åä¼šè¿è¡Œä½ çš„ä»£ç ï¼Œå¦‚æœé‡æ–°è®­ç»ƒçš„è¯ä¼šèŠ±è´¹å¤§é‡çš„æ—¶é—´æ‰èƒ½å¾—åˆ°åˆ†æ•°ã€‚</p><h3 id="ArialTTF"><a href="#ArialTTF" class="headerlink" title="ArialTTF"></a>ArialTTF</h3><p>å…ˆè¯´ä¸€ä¸‹è¿™ä¸ªæ•°æ®é›†å§ï¼Œè¿™æ˜¯åœ¨ç”¨YOLOv5è®­ç»ƒçš„æ—¶å€™æŠ¥é”™å‘ç°çš„ï¼Œå®ƒè¯´æ²¡æœ‰Arialå­—ä½“æ–‡ä»¶ã€‚å› ä¸ºYOLOv5è®­ç»ƒç»“æŸåä¼šå±•ç¤ºä¸€äº›å›¾ç‰‡ï¼Œä¸Šé¢ä¼šç”»æ¡†å’Œæ ‡æ³¨æ ‡ç­¾ï¼Œéœ€è¦å­—ä½“æ–‡ä»¶ã€‚Arialåº”è¯¥æ˜¯æœ€åŸºæœ¬çš„è‹±æ–‡å­—ä½“æ–‡ä»¶äº†ï¼Œç„¶è€ŒKaggleç¯å¢ƒé‡Œå¹¶æ²¡æœ‰ï¼Œæ‰€ä»¥éœ€è¦åœ¨inputåŠ ä¸Šè¿™ä¸ªå­—ä½“æ–‡ä»¶ï¼Œä¸‹é¢ä¼šæåˆ°æ€ä¹ˆå¤„ç†è¿™ä¸ªå­—ä½“æ–‡ä»¶ã€‚</p><p>åˆ›å»ºæ–¹æ³•å¾ˆç®€å•ï¼Œåœ¨notebookç¼–è¾‘é¡µé¢ç‚¹å‡»ä¸Šä¼ inputï¼Œé€‰æ‹©datasetï¼Œä¸Šä¼ åœ¨ç½‘ä¸Šä¸‹è½½å¥½çš„å­—ä½“æ–‡ä»¶å³å¯ã€‚</p><h3 id="YOLOv5-amp-Dependences"><a href="#YOLOv5-amp-Dependences" class="headerlink" title="YOLOv5&amp;Dependences"></a>YOLOv5&amp;Dependences</h3><p>è¿™ä¸ªnotebookå¯ä»¥è¿æ¥ç½‘ç»œã€‚å…¶å®åªæœ‰æœ€åæäº¤çš„notebook offlineå°±è¡Œã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>WTFï¼ŒWTFï¼ŒWTFã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>æ‰€ä»¥æˆ‘ä¸ºä»€ä¹ˆè¦å†™ä¸‰ä¸ªnotebookï¼Œæˆ‘ä¸ºä»€ä¹ˆè¦åœ¨trainçš„æ—¶å€™ä¹Ÿç¦»çº¿äº†ã€‚ã€‚ã€‚</p><p>æˆ‘çœŸçš„æ˜¯å†™åˆ°è¿™é‡Œçš„æ—¶å€™æ‰æ„è¯†åˆ°è¿™ä¸ªé—®é¢˜ã€‚</p><p>å› ä¸ºå½“å‰è¿™ä¸ª<code>YOLOv5&amp;Dependences</code> notebookä¸»è¦è§£å†³çš„æ˜¯ç¦»çº¿notebookä¸èƒ½ä½¿ç”¨git,pipå‘½ä»¤è¿›è¡Œåœ¨çº¿æ“ä½œçš„é—®é¢˜ã€‚æˆ‘æƒ³çš„æ˜¯åœ¨è¿™é‡Œä¸‹è½½å¥½YOLOv5å’Œä¾èµ–åŒ…ä¹‹åï¼Œåœ¨<code>WheatDetectOffineTrain</code>é‡Œé¢ä½œä¸ºinputè¿›è¡ŒåŠ è½½å°±å¯ä»¥ç¦»çº¿ä½¿ç”¨YOLOv5äº†ã€‚</p><p>å®é™…ä¸Š<code>WheatDetectOffineTrain</code>å®Œå…¨å¯ä»¥è”ç½‘ä¸‹è½½å’Œå®‰è£…ä¾èµ–ï¼Œæ‰€ä»¥è¿™ä¸ªnotebookå®Œå…¨æ²¡æœ‰å­˜åœ¨çš„å¿…è¦ã€‚</p><p>æˆ‘ç»ˆäºæ˜ç™½discussioné‡Œé¢æœ‰äººè¯´çš„ä½ éœ€è¦åˆ›å»ºä¸¤ä¸ªnotebookï¼Œä¸€ä¸ªç”¨æ¥è®­ç»ƒï¼Œä¸€ä¸ªç”¨æ¥æ£€æµ‹æ˜¯ä»€ä¹ˆæ„æ€äº†ã€‚å¹¶ä¸æ˜¯éœ€è¦ï¼Œè€Œæ˜¯â€œåªâ€éœ€è¦ä¸¤ä¸ªã€‚</p><p>ä¸è¿‡è¿˜æ˜¯è®°å½•ä¸€ä¸‹è¿™ä¸ªnotebookçš„ä»£ç å§ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">!git clone https://github.com/ultralytics/yolov5</span><br><span class="line"><span class="meta prompt_">%</span><span class="language-bash"><span class="built_in">cd</span> yolov5</span></span><br><span class="line">!pip download -r requirements.txt -d dependences</span><br><span class="line">!mkdir -p weights</span><br><span class="line">!wget -P weights https://github.com/ultralytics/yolov5/releases/download/v7.0/yolov5s.pt</span><br></pre></td></tr></table></figure><p>å› ä¸ºé¢„è®­ç»ƒæ–‡ä»¶æ˜¯åœ¨çº¿åŠ è½½çš„ï¼Œæ‰€ä»¥ä¹Ÿå¾—æå‰ä¸‹è½½ã€‚ã€‚ã€‚</p><h3 id="WheatDetectOffineTrain"><a href="#WheatDetectOffineTrain" class="headerlink" title="WheatDetectOffineTrain"></a>WheatDetectOffineTrain</h3><p>å¥½ï¼Œæ¥ä¸‹æ¥è®°å½•ä¸€ä¸‹è¿™ä¸ªâ€œç¦»çº¿â€è®­ç»ƒçš„notebookã€‚</p><p>é¦–å…ˆè¦å…ˆæ·»åŠ inputï¼Œå°†ä¸Šé¢ä¸¤ä¸ªåŠ è½½è¿›æ¥ã€‚</p><p>ç„¶åå®‰è£…ä¾èµ–ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!pip install --no-index --find-links=/kaggle/input/yolov5-dependences/yolov5/dependences -r /kaggle/input/yolov5-dependences/yolov5/requirements.txt</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œè¿è¡Œå®Œåä¼šçœ‹è§æŠ¥é”™ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ERROR: pip&#x27;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.</span><br><span class="line">torchaudio 2.6.0+cu124 requires torch==2.6.0, but you have torch 2.7.1 which is incompatible.</span><br><span class="line">fastai 2.7.19 requires torch&lt;2.7,&gt;=1.10, but you have torch 2.7.1 which is incompatible.</span><br></pre></td></tr></table></figure><br>å¥½åƒæ˜¯å› ä¸ºæœ¬åœ°torchç‰ˆæœ¬å¤ªé«˜äº†ï¼Œä¸è¿‡ä¸ç”¨ç†ä¼šï¼Œä»£ç èƒ½æ­£å¸¸è¿è¡Œã€‚</p><p>åˆ›å»ºæ•°æ®é›†æ–‡ä»¶å¤¹<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.makedirs(<span class="string">&#x27;/kaggle/working/wheat&#x27;</span>, exist_ok=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></p><p>å°†æ ‡ç­¾è½¬æ¢æˆYOLOæ ¼å¼ï¼š<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="comment"># set path</span></span><br><span class="line">csv_path = <span class="string">r&#x27;/kaggle/input/global-wheat-detection/train.csv&#x27;</span></span><br><span class="line">image_dir = <span class="string">r&#x27;/kaggle/input/global-wheat-detection/train&#x27;</span></span><br><span class="line">label_output_dir = <span class="string">r&#x27;/kaggle/working/wheat/labels&#x27;</span></span><br><span class="line"></span><br><span class="line">os.makedirs(label_output_dir,exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">df = pd.read_csv(csv_path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£æ bbox å­—ç¬¦ä¸²ä¸º float ç±»å‹çš„ [x, y, w, h]</span></span><br><span class="line">df[[<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;h&#x27;</span>]] = df[<span class="string">&#x27;bbox&#x27;</span>].apply(<span class="keyword">lambda</span> x: <span class="built_in">eval</span>(x)).apply(pd.Series)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert_bbox_to_yolo</span>(<span class="params">size,box</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    size: (width,height)</span></span><br><span class="line"><span class="string">    box: (x_min, y_min, width, height)</span></span><br><span class="line"><span class="string">    return: normalized (x_center, y_center, width, height)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    dw, dh = <span class="number">1.</span> / size[<span class="number">0</span>], <span class="number">1.</span> / size[<span class="number">1</span>]</span><br><span class="line">    x_center = (box[<span class="number">0</span>] + box[<span class="number">2</span>] / <span class="number">2.0</span>) * dw</span><br><span class="line">    y_center = (box[<span class="number">1</span>] + box[<span class="number">3</span>] / <span class="number">2.0</span>) * dh</span><br><span class="line">    w = box[<span class="number">2</span>] * dw</span><br><span class="line">    h = box[<span class="number">3</span>] * dh</span><br><span class="line">    <span class="keyword">return</span> x_center, y_center, w, h</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> image_id, group <span class="keyword">in</span> tqdm(df.groupby(<span class="string">&#x27;image_id&#x27;</span>), desc=<span class="string">&quot;Generating labels&quot;</span>):</span><br><span class="line">    image_path = os.path.join(image_dir,image_id + <span class="string">&#x27;.jpg&#x27;</span>)</span><br><span class="line">    label_path = os.path.join(label_output_dir, image_id + <span class="string">&#x27;.txt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(image_path):</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">with</span> Image.<span class="built_in">open</span>(image_path) <span class="keyword">as</span> img:</span><br><span class="line">        img_w, img_h = img.size</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(label_path,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> _, row <span class="keyword">in</span> group.iterrows():</span><br><span class="line">            x_center, y_center, w, h = convert_bbox_to_yolo((img_w, img_h), (row[<span class="string">&#x27;x&#x27;</span>], row[<span class="string">&#x27;y&#x27;</span>], row[<span class="string">&#x27;w&#x27;</span>], row[<span class="string">&#x27;h&#x27;</span>]))</span><br><span class="line">            f.write(<span class="string">f&quot;0 <span class="subst">&#123;x_center:<span class="number">.6</span>f&#125;</span> <span class="subst">&#123;y_center:<span class="number">.6</span>f&#125;</span> <span class="subst">&#123;w:<span class="number">.6</span>f&#125;</span> <span class="subst">&#123;h:<span class="number">.6</span>f&#125;</span>\n&quot;</span>)</span><br></pre></td></tr></table></figure></p><p>è¾“å‡ºï¼š<code>Generating labels: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3373/3373 [00:23&lt;00:00, 144.72it/s]</code></p><p>æ•´ç†å›¾åƒæ–‡ä»¶å¤¹ï¼Œç¬¦åˆYOLOè¦æ±‚ï¼Œåˆ’åˆ†è®­ç»ƒé›†éªŒè¯é›†ã€‚<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line">image_dir = Path(<span class="string">r&#x27;/kaggle/input/global-wheat-detection/train&#x27;</span>)</span><br><span class="line">label_dir = Path(<span class="string">r&#x27;/kaggle/working/wheat/labels&#x27;</span>)</span><br><span class="line">output_base = Path(<span class="string">r&#x27;/kaggle/working/wheat/yolo&#x27;</span>)</span><br><span class="line"></span><br><span class="line">os.makedirs(output_base,exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">train_ratio = <span class="number">0.8</span></span><br><span class="line"></span><br><span class="line">output_images_train = output_base / <span class="string">&#x27;images/train&#x27;</span></span><br><span class="line">output_images_val = output_base / <span class="string">&#x27;images/val&#x27;</span></span><br><span class="line">output_labels_train = output_base / <span class="string">&#x27;labels/train&#x27;</span></span><br><span class="line">output_labels_val = output_base / <span class="string">&#x27;labels/val&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºç›®æ ‡æ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="keyword">for</span> path <span class="keyword">in</span> [output_images_train, output_images_val, output_labels_train, output_labels_val]:</span><br><span class="line">    os.makedirs(path, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">image_files = <span class="built_in">list</span>(image_dir.glob(<span class="string">&#x27;*.jpg&#x27;</span>))</span><br><span class="line"><span class="comment"># stem is to remove .jpg</span></span><br><span class="line">image_ids = [img.stem <span class="keyword">for</span> img <span class="keyword">in</span> image_files] </span><br><span class="line"></span><br><span class="line">random.seed(<span class="number">42</span>)</span><br><span class="line">random.shuffle(image_ids)</span><br><span class="line"></span><br><span class="line">split_index = <span class="built_in">int</span>(<span class="built_in">len</span>(image_ids) * train_ratio)</span><br><span class="line">train_ids = image_ids[:split_index]</span><br><span class="line">val_ids = image_ids[split_index:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">copy_files</span>(<span class="params">image_ids, image_dst, label_dst</span>):</span><br><span class="line">    <span class="keyword">for</span> image_id <span class="keyword">in</span> image_ids:</span><br><span class="line">        src_img = image_dir / <span class="string">f&quot;<span class="subst">&#123;image_id&#125;</span>.jpg&quot;</span></span><br><span class="line">        dst_img = image_dst / <span class="string">f&quot;<span class="subst">&#123;image_id&#125;</span>.jpg&quot;</span></span><br><span class="line">        shutil.copy2(src_img,dst_img)</span><br><span class="line"></span><br><span class="line">        src_label = label_dir / <span class="string">f&quot;<span class="subst">&#123;image_id&#125;</span>.txt&quot;</span></span><br><span class="line">        dst_label = label_dst / <span class="string">f&quot;<span class="subst">&#123;image_id&#125;</span>.txt&quot;</span></span><br><span class="line">        <span class="keyword">if</span> src_label.exists():</span><br><span class="line">            shutil.copy2(src_label, dst_label)</span><br><span class="line">        <span class="keyword">else</span>: </span><br><span class="line">            dst_label.write_text(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">copy_files(train_ids, output_images_train,output_labels_train)</span><br><span class="line">copy_files(val_ids, output_images_val,output_labels_val)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;âœ… åˆ’åˆ†å®Œæˆï¼š<span class="subst">&#123;<span class="built_in">len</span>(train_ids)&#125;</span> å¼ ç”¨äºè®­ç»ƒï¼Œ<span class="subst">&#123;<span class="built_in">len</span>(val_ids)&#125;</span> å¼ ç”¨äºéªŒè¯ã€‚&quot;</span>)</span><br></pre></td></tr></table></figure></p><p>è¾“å‡ºï¼š<code>âœ… åˆ’åˆ†å®Œæˆï¼š2737 å¼ ç”¨äºè®­ç»ƒï¼Œ685 å¼ ç”¨äºéªŒè¯ã€‚</code></p><p><strong>æ³¨æ„ï¼šæ²¡æœ‰æ¡†çš„å›¾ç‰‡ä¹Ÿéœ€è¦ä¸€ä¸ªå¯¹åº”çš„ç©ºtxtæ–‡ä»¶</strong></p><p>ç¼–å†™yamlæ–‡ä»¶ï¼š<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">yaml_content = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">path: /kaggle/working/wheat/yolo</span></span><br><span class="line"><span class="string">train: images/train</span></span><br><span class="line"><span class="string">val: images/val</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">nc: 1</span></span><br><span class="line"><span class="string">names: [&#x27;wheat&#x27;]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;wheat.yaml&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(yaml_content)</span><br></pre></td></tr></table></figure></p><p>å°†YOLOv5æ‹·è´åˆ°workingæ–‡ä»¶å¤¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!cp -r /kaggle/input/yolov5-dependences/yolov5 /kaggle/working/yolov5</span><br></pre></td></tr></table></figure><p>å› ä¸ºYOLOv5åœ¨è¿è¡Œçš„æ—¶å€™wandbä¼šè”ç½‘è¿›è¡Œgitæ£€æŸ¥ï¼Œç„¶è€Œå½“å‰æ˜¯offlineçš„ï¼Œä¼šé€ æˆæ— æ³•è¿è¡Œçš„æƒ…å†µã€‚è¿™é‡Œä½¿ç”¨äº†chatgptæ•™æˆ‘çš„â€œçŒ´å­æˆæ³•â€ï¼Œå°†æ‰§è¡Œæ£€æŸ¥çš„å‡½æ•°æ— æ•ˆåŒ–ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> types</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.path.append(<span class="string">&#x27;/kaggle/working/yolov5&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> utils.general <span class="keyword">as</span> general</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dummy_check_git_info</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;unknown&#x27;</span></span><br><span class="line"></span><br><span class="line">general.check_git_info = dummy_check_git_info</span><br></pre></td></tr></table></figure><p>å®‰è£…å­—ä½“æ–‡ä»¶,æˆ‘ä»¬åªéœ€è¦å°†å­—ä½“æ–‡ä»¶ç§»åŠ¨åˆ°yoloä¼šå¯»æ‰¾å­—ä½“çš„åœ°æ–¹å³å¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">!mkdir -p /root/.config/Ultralytics/</span><br><span class="line">!cp /kaggle/input/arialttf/Arial.ttf /root/.config/Ultralytics/Arial.ttf</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œè®­ç»ƒå‘½ä»¤ï¼Œè¿™é‡Œå…ˆè¿›å…¥åˆ°YOLOæ–‡ä»¶å¤¹ä¸‹ï¼Œç®€åŒ–å‘½ä»¤ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">%</span><span class="language-bash"><span class="built_in">cd</span> /kaggle/working/yolov5/</span></span><br><span class="line">!python train.py --img 640 --batch 16 --epochs 50 --data /kaggle/working/wheat.yaml --weights weights/yolov5s.pt --name wheat_yolov5</span><br></pre></td></tr></table></figure></p><p>åˆ°æ­¤å°±å¯ä»¥äº†ï¼Œæ‰§è¡Œ<code>Save &amp; Run All(commit)</code>ç­‰å¾…è®­ç»ƒå®Œæˆåå°±å¯ä»¥è¿›è¡Œæ£€æµ‹äº†ã€‚æˆ‘å¹¶æ²¡æœ‰è¿›è¡Œå›¾ç‰‡å¢å¼ºï¼Œå¢åŠ æ•°æ®é›†çš„æ“ä½œè€Œç›´æ¥è®­ç»ƒçš„ï¼Œæ‰€ä»¥æœ€åæ£€æµ‹ç»“æœä¼šæœ‰ä¸€ç‚¹ä½ã€‚</p><h3 id="WheatDetectOfflineDetect"><a href="#WheatDetectOfflineDetect" class="headerlink" title="WheatDetectOfflineDetect"></a>WheatDetectOfflineDetect</h3><p>æå‰åŠ è½½å­—ä½“æ–‡ä»¶ï¼Œ<code>YOLOv5&amp;Dependences</code>å’Œ<code>WheatDetectOffineTrain</code>çš„outputã€‚</p><p>çªç„¶æ„è¯†åˆ°<code>YOLOv5&amp;Dependences</code>ä¹Ÿè¿˜æ˜¯æœ‰ä¸€ç‚¹å­˜åœ¨çš„å¿…è¦çš„ï¼Œæ£€æµ‹æ–‡ä»¶ä¹Ÿéœ€è¦å®‰è£…ç¯å¢ƒï¼Œè™½ç„¶è¯´åœ¨è®­ç»ƒæ–‡ä»¶é‡Œä¹Ÿå¯ä»¥ä¸‹è½½ã€‚</p><p>å®‰è£…ä¾èµ–ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!pip install --no-index --find-links=/kaggle/input/yolov5-dependences/yolov5/dependences -r /kaggle/input/yolov5-dependences/yolov5/requirements.txt</span><br></pre></td></tr></table></figure></p><p>æ‹·è´è®­ç»ƒåçš„YOLOv5æ–‡ä»¶å¤¹ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!cp -r /kaggle/input/wheatdetectoffinetrain/yolov5 /kaggle/working/yolov5</span><br></pre></td></tr></table></figure><br>è¿™æ—¶yolov5é¡¹ç›®æ–‡ä»¶å¤¹é‡Œæ˜¯æœ‰è®­ç»ƒåçš„<code>runs</code>æ–‡ä»¶å¤¹çš„ã€‚</p><p>å®‰è£…å­—ä½“ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">!mkdir -p /root/.config/Ultralytics/</span><br><span class="line">!cp /kaggle/input/arialttf/Arial.ttf /root/.config/Ultralytics/Arial.ttf</span><br></pre></td></tr></table></figure></p><p>è½¬æ¢å·¥ä½œç›®å½•ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">%</span><span class="language-bash"><span class="built_in">cd</span> /kaggle/working/yolov5/</span></span><br></pre></td></tr></table></figure></p><p>æ£€æµ‹å‘½ä»¤ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!python detect.py --weights runs/train/wheat_yolov5/weights/best.pt --source /kaggle/input/global-wheat-detection/test --img 640 --conf 0.25 --save-txt --save-conf --project runs/predict --name wheat_test</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œè¯´æ˜ä¸€ä¸‹ï¼Œ<code>--conf</code>æ˜¯ä¿ç•™ç½®ä¿¡åº¦ï¼Œ<code>--save-txt</code>æ˜¯ä¿å­˜ä¸ºtxtæ–‡ä»¶ã€‚</p><p>è½¬æ¢yoloè¾“å‡ºå¹¶ç”Ÿæˆ<code>submission.csv</code>æ–‡ä»¶:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·¯å¾„é…ç½®</span></span><br><span class="line">test_images_dir = Path(<span class="string">r&#x27;/kaggle/input/global-wheat-detection/test&#x27;</span>)</span><br><span class="line">pred_labels_dir = Path(<span class="string">r&#x27;/kaggle/working/yolov5/runs/predict/wheat_test/labels&#x27;</span>)</span><br><span class="line">submission_path = <span class="string">&#x27;/kaggle/working/submission.csv&#x27;</span></span><br><span class="line"></span><br><span class="line">results = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> image_path <span class="keyword">in</span> test_images_dir.glob(<span class="string">&#x27;*.jpg&#x27;</span>):</span><br><span class="line">    image_id = image_path.stem</span><br><span class="line">    label_path = pred_labels_dir / <span class="string">f&quot;<span class="subst">&#123;image_id&#125;</span>.txt&quot;</span></span><br><span class="line"></span><br><span class="line">    prediction_string = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> label_path.exists():</span><br><span class="line">        <span class="keyword">with</span> Image.<span class="built_in">open</span>(image_path) <span class="keyword">as</span> im:</span><br><span class="line">            img_w, img_h = im.size</span><br><span class="line"></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(label_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">                parts = line.strip().split()</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(parts) == <span class="number">6</span>:</span><br><span class="line">                    cls, x_center, y_center, width, height, conf = <span class="built_in">map</span>(<span class="built_in">float</span>, parts)</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># è½¬å›å·¦ä¸Šè§’åæ ‡</span></span><br><span class="line">                    x_min = (x_center - width / <span class="number">2</span>) * img_w</span><br><span class="line">                    y_min = (y_center - height / <span class="number">2</span>) * img_h</span><br><span class="line">                    box_w = width * img_w</span><br><span class="line">                    box_h = height * img_h</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># æ‹¼æ¥å­—ç¬¦ä¸²ï¼šconfidence x y w h</span></span><br><span class="line">                    prediction_string += <span class="string">f&quot;<span class="subst">&#123;conf:<span class="number">.4</span>f&#125;</span> <span class="subst">&#123;x_min:<span class="number">.1</span>f&#125;</span> <span class="subst">&#123;y_min:<span class="number">.1</span>f&#125;</span> <span class="subst">&#123;box_w:<span class="number">.1</span>f&#125;</span> <span class="subst">&#123;box_h:<span class="number">.1</span>f&#125;</span> &quot;</span></span><br><span class="line"></span><br><span class="line">    results.append(&#123;</span><br><span class="line">        <span class="string">&quot;image_id&quot;</span>: image_id,</span><br><span class="line">        <span class="string">&quot;PredictionString&quot;</span>: prediction_string.strip()</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿å­˜ä¸º CSV</span></span><br><span class="line">df = pd.DataFrame(results)</span><br><span class="line">df.to_csv(submission_path, index=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;âœ… å·²ä¿å­˜æäº¤æ–‡ä»¶: <span class="subst">&#123;submission_path&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆåˆ†æ•°å¦‚ä¸‹ï¼š<br><img src="https://images.whff521.top/Screenshot%202025-07-22%20at%2015.00.49.png" alt="åˆ†æ•°"></p><p>è™½ç„¶ä¸æ˜¯å¾ˆé«˜ï¼Œä½†æ˜¯åœ¨å½“å¹´çš„æ’è¡Œæ¦œä¸Šèƒ½æ’åˆ°ç¬¬ä¸‰çš„ä½ç½®ï¼ˆæ„Ÿè°¢YOLOï¼‰</p><p>PSï¼šå°é¢å›¾æ¥æºï¼š<a href="https://x.com/nakiriayame/status/1946793366399918121?s=46"><br>ç™¾é¬¼ã‚ã‚„ã‚ğŸ˜ˆãƒ›ãƒ­ãƒ©ã‚¤ãƒ–2æœŸç”Ÿ</a></p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;Kaggle-ç¦»çº¿ä½¿ç”¨YOLOv5â€”â€”Global-Wheat-Detection&quot;&gt;&lt;a href=&quot;#Kaggle-ç¦»çº¿ä½¿ç”¨YOLOv5â€”â€”Global-Wheat-Detection&quot; class=&quot;headerlink&quot; title=&quot;Kaggle</summary>
        
      
    
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://blog.whff521.xyz/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="yolo" scheme="https://blog.whff521.xyz/tags/yolo/"/>
    
    <category term="Kaggle" scheme="https://blog.whff521.xyz/tags/Kaggle/"/>
    
  </entry>
  
  <entry>
    <title>YOLOv5ä½¿ç”¨æ–¹æ³•</title>
    <link href="https://blog.whff521.xyz/2025/07/21/YOLOv5%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
    <id>https://blog.whff521.xyz/2025/07/21/YOLOv5%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</id>
    <published>2025-07-21T02:40:45.000Z</published>
    <updated>2025-07-21T03:25:42.145Z</updated>
    
    <content type="html"><![CDATA[<h1 id="YOLOv5ä½¿ç”¨æ–¹æ³•"><a href="#YOLOv5ä½¿ç”¨æ–¹æ³•" class="headerlink" title="YOLOv5ä½¿ç”¨æ–¹æ³•"></a>YOLOv5ä½¿ç”¨æ–¹æ³•</h1><h2 id="æ•°æ®é›†"><a href="#æ•°æ®é›†" class="headerlink" title="æ•°æ®é›†"></a>æ•°æ®é›†</h2><p>YOLOv5 ä½¿ç”¨çš„æ•°æ®é›†éµå¾ªçš„æ˜¯ <strong>YOLOæ ¼å¼ï¼ˆYOLO annotation formatï¼‰</strong>ã€‚ä»¥ä¸‹æ˜¯ YOLOv5 æ‰€éœ€æ•°æ®é›†çš„å®Œæ•´è§„èŒƒï¼š</p><hr><h4 id="âœ…-1-ç›®å½•ç»“æ„"><a href="#âœ…-1-ç›®å½•ç»“æ„" class="headerlink" title="âœ… 1. ç›®å½•ç»“æ„"></a>âœ… 1. <strong>ç›®å½•ç»“æ„</strong></h4><p>YOLOv5 é€šå¸¸çš„æ•°æ®é›†ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">dataset/</span><br><span class="line">â”œâ”€â”€ images/</span><br><span class="line">â”‚   â”œâ”€â”€ train/</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ img1.jpg</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ img2.jpg</span><br><span class="line">â”‚   â”œâ”€â”€ val/</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ img3.jpg</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ img4.jpg</span><br><span class="line">â”‚</span><br><span class="line">â”œâ”€â”€ labels/</span><br><span class="line">â”‚   â”œâ”€â”€ train/</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ img1.txt</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ img2.txt</span><br><span class="line">â”‚   â”œâ”€â”€ val/</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ img3.txt</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ img4.txt</span><br><span class="line">â”‚</span><br><span class="line">â””â”€â”€ data.yaml</span><br></pre></td></tr></table></figure><hr><h4 id="âœ…-2-æ ‡ç­¾æ–‡ä»¶æ ¼å¼ï¼ˆ-txtï¼‰"><a href="#âœ…-2-æ ‡ç­¾æ–‡ä»¶æ ¼å¼ï¼ˆ-txtï¼‰" class="headerlink" title="âœ… 2. æ ‡ç­¾æ–‡ä»¶æ ¼å¼ï¼ˆ.txtï¼‰"></a>âœ… 2. <strong>æ ‡ç­¾æ–‡ä»¶æ ¼å¼ï¼ˆ<code>.txt</code>ï¼‰</strong></h4><p>æ¯å¼ å›¾åƒå¯¹åº”ä¸€ä¸ª <code>.txt</code> æ–‡ä»¶ï¼Œå‘½åç›¸åŒï¼Œå†…å®¹å¦‚ä¸‹æ ¼å¼ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;class_id&gt; &lt;x_center&gt; &lt;y_center&gt; &lt;width&gt; &lt;height&gt;</span><br></pre></td></tr></table></figure><h5 id="åæ ‡è¯´æ˜ï¼š"><a href="#åæ ‡è¯´æ˜ï¼š" class="headerlink" title="åæ ‡è¯´æ˜ï¼š"></a>åæ ‡è¯´æ˜ï¼š</h5><ul><li><code>class_id</code>ï¼šæ•´æ•°ï¼Œè¡¨ç¤ºç›®æ ‡æ‰€å±çš„ç±»åˆ«ï¼Œä»0å¼€å§‹ã€‚</li><li><code>x_center</code>ã€<code>y_center</code>ï¼šç›®æ ‡ä¸­å¿ƒçš„ç›¸å¯¹ä½ç½®ï¼ˆèŒƒå›´æ˜¯0~1ï¼Œç›¸å¯¹äºå›¾åƒå®½åº¦å’Œé«˜åº¦ï¼‰ã€‚</li><li><code>width</code>ã€<code>height</code>ï¼šç›®æ ‡æ¡†çš„ç›¸å¯¹å®½åº¦å’Œé«˜åº¦ï¼ˆèŒƒå›´0~1ï¼‰ã€‚</li></ul><p>ä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 0.5 0.5 0.2 0.3</span><br></pre></td></tr></table></figure><p>è¡¨ç¤ºç¬¬0ç±»ç‰©ä½“ï¼Œå…¶è¾¹ç•Œæ¡†ä¸­å¿ƒåœ¨å›¾åƒæ­£ä¸­é—´ï¼Œå®½20%ï¼Œé«˜30%ã€‚</p><hr><h4 id="âœ…-3-data-yaml-æ–‡ä»¶æ ¼å¼"><a href="#âœ…-3-data-yaml-æ–‡ä»¶æ ¼å¼" class="headerlink" title="âœ… 3. data.yaml æ–‡ä»¶æ ¼å¼"></a>âœ… 3. <strong><code>data.yaml</code> æ–‡ä»¶æ ¼å¼</strong></h4><p>ç”¨äºé…ç½®è®­ç»ƒé›†ã€éªŒè¯é›†ã€ç±»åˆ«åç­‰ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># path: ./dataset</span></span><br><span class="line"><span class="attr">train:</span> <span class="string">images/train</span></span><br><span class="line"><span class="attr">val:</span> <span class="string">images/val</span></span><br><span class="line"><span class="comment"># test: ./dataset/images/test</span></span><br><span class="line"><span class="attr">nc:</span> <span class="number">3</span>  <span class="comment"># ç±»åˆ«æ•°é‡</span></span><br><span class="line"><span class="attr">names:</span> [<span class="string">&#x27;cat&#x27;</span>, <span class="string">&#x27;dog&#x27;</span>, <span class="string">&#x27;person&#x27;</span>]  <span class="comment"># ç±»åˆ«åç§°åˆ—è¡¨</span></span><br></pre></td></tr></table></figure><p>æ³¨é‡Šä»£è¡¨éå¿…é¡»å­—æ®µï¼Œ<code>path</code>æŒ‡å®šååé¢çš„è·¯å¾„åªéœ€å†™ç›¸å¯¹è·¯å¾„</p><hr><h4 id="âœ…-4-å›¾ç‰‡æ ¼å¼"><a href="#âœ…-4-å›¾ç‰‡æ ¼å¼" class="headerlink" title="âœ… 4. å›¾ç‰‡æ ¼å¼"></a>âœ… 4. <strong>å›¾ç‰‡æ ¼å¼</strong></h4><ul><li>æ”¯æŒå¸¸è§æ ¼å¼ï¼š<code>.jpg</code>, <code>.jpeg</code>, <code>.png</code></li><li>å›¾ç‰‡å°ºå¯¸ä¸å¿…ç»Ÿä¸€ï¼Œä½†å»ºè®®å¤§å°é€‚ä¸­ï¼ˆè®­ç»ƒæ—¶å¯è‡ªåŠ¨resizeï¼‰</li></ul><hr><h4 id="âœ…-5-å¸¸è§æ³¨æ„äº‹é¡¹"><a href="#âœ…-5-å¸¸è§æ³¨æ„äº‹é¡¹" class="headerlink" title="âœ… 5. å¸¸è§æ³¨æ„äº‹é¡¹"></a>âœ… 5. <strong>å¸¸è§æ³¨æ„äº‹é¡¹</strong></h4><ul><li>æ ‡ç­¾æ–‡ä»¶ä¸­åæ ‡å¿…é¡»æ˜¯ <strong>å½’ä¸€åŒ–æ ¼å¼</strong>ï¼Œå³ç›¸å¯¹äºå›¾åƒå®½é«˜ï¼ŒèŒƒå›´åœ¨ <code>[0, 1]</code>ã€‚</li><li>æ¯ä¸€è¡Œä¸ºä¸€ä¸ªæ ‡æ³¨æ¡†ï¼Œ<strong>æ²¡æœ‰æ ‡æ³¨çš„å›¾åƒä¹Ÿå¿…é¡»æœ‰ç©ºçš„ <code>.txt</code> æ–‡ä»¶</strong>ã€‚</li><li><code>images/train</code> å’Œ <code>labels/train</code> ä¸­çš„æ–‡ä»¶åå¿…é¡»ä¸€ä¸€å¯¹åº”ã€‚</li></ul><hr><h4 id="âœ…-ç¤ºä¾‹"><a href="#âœ…-ç¤ºä¾‹" class="headerlink" title="âœ… ç¤ºä¾‹"></a>âœ… ç¤ºä¾‹</h4><p>å‡è®¾æœ‰ä¸€å¼ å›¾åƒ <code>dog.jpg</code> å°ºå¯¸ä¸º <code>800x600</code>ï¼Œç›®æ ‡ç‹—çš„ä½ç½®æ˜¯ï¼š</p><ul><li>å·¦ä¸Šè§’ <code>(x1=200, y1=150)</code></li><li>å³ä¸‹è§’ <code>(x2=600, y2=450)</code></li></ul><p>åˆ™ï¼š</p><ul><li><code>x_center = (200+600)/2 / 800 = 0.5</code></li><li><code>y_center = (150+450)/2 / 600 = 0.5</code></li><li><code>width = (600 - 200) / 800 = 0.5</code></li><li><code>height = (450 - 150) / 600 = 0.5</code></li></ul><p>æ ‡ç­¾è¡Œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 0.5 0.5 0.5 0.5</span><br></pre></td></tr></table></figure><p>ï¼ˆå‡è®¾â€œç‹—â€çš„ <code>class_id=1</code>ï¼‰</p><h2 id="é…ç½®æ–‡ä»¶è¯´æ˜"><a href="#é…ç½®æ–‡ä»¶è¯´æ˜" class="headerlink" title="é…ç½®æ–‡ä»¶è¯´æ˜"></a>é…ç½®æ–‡ä»¶è¯´æ˜</h2><p>YOLOv5 çš„é…ç½®æ–‡ä»¶ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ç±»ï¼Œå®ƒä»¬ç”¨äºé…ç½®æ¨¡å‹ç»“æ„ã€è®­ç»ƒè¿‡ç¨‹ã€æ•°æ®é›†è·¯å¾„ç­‰ã€‚ä¸‹é¢æ˜¯å„ç±»é…ç½®æ–‡ä»¶çš„è¯´æ˜ï¼š</p><hr><h4 id="ğŸ—‚-1-data-yaml-â€”-æ•°æ®é›†é…ç½®æ–‡ä»¶ï¼ˆè®­ç»ƒ-éªŒè¯-æµ‹è¯•è·¯å¾„-ç±»åˆ«ä¿¡æ¯ï¼‰"><a href="#ğŸ—‚-1-data-yaml-â€”-æ•°æ®é›†é…ç½®æ–‡ä»¶ï¼ˆè®­ç»ƒ-éªŒè¯-æµ‹è¯•è·¯å¾„-ç±»åˆ«ä¿¡æ¯ï¼‰" class="headerlink" title="ğŸ—‚ 1. data.yaml â€” æ•°æ®é›†é…ç½®æ–‡ä»¶ï¼ˆè®­ç»ƒ/éªŒè¯/æµ‹è¯•è·¯å¾„ + ç±»åˆ«ä¿¡æ¯ï¼‰"></a>ğŸ—‚ 1. <code>data.yaml</code> â€” æ•°æ®é›†é…ç½®æ–‡ä»¶ï¼ˆ<strong>è®­ç»ƒ/éªŒè¯/æµ‹è¯•è·¯å¾„ + ç±»åˆ«ä¿¡æ¯</strong>ï¼‰</h4><p>ä½ç½®ï¼šä½ è‡ªå·±åˆ›å»ºæˆ–æ”¾åœ¨ <code>data/</code> ç›®å½•ä¸­</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¤ºä¾‹</span></span><br><span class="line"><span class="attr">path:</span> <span class="string">../dataset</span>                 <span class="comment"># æ•°æ®é›†æ ¹è·¯å¾„ï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line"><span class="attr">train:</span> <span class="string">images/train</span>              <span class="comment"># è®­ç»ƒå›¾ç‰‡è·¯å¾„ï¼ˆç›¸å¯¹ path æˆ–ç»å¯¹è·¯å¾„ï¼‰</span></span><br><span class="line"><span class="attr">val:</span> <span class="string">images/val</span>                  <span class="comment"># éªŒè¯å›¾ç‰‡è·¯å¾„</span></span><br><span class="line"><span class="attr">test:</span> <span class="string">images/test</span>                <span class="comment"># ï¼ˆå¯é€‰ï¼‰æµ‹è¯•å›¾ç‰‡è·¯å¾„</span></span><br><span class="line"></span><br><span class="line"><span class="attr">nc:</span> <span class="number">3</span>                            <span class="comment"># ç±»åˆ«æ•°é‡</span></span><br><span class="line"><span class="attr">names:</span> [<span class="string">&#x27;cat&#x27;</span>, <span class="string">&#x27;dog&#x27;</span>, <span class="string">&#x27;person&#x27;</span>]  <span class="comment"># ç±»åˆ«åç§°åˆ—è¡¨</span></span><br></pre></td></tr></table></figure><hr><h4 id="ğŸ“-2-yaml-â€”-æ¨¡å‹ç»“æ„é…ç½®æ–‡ä»¶ï¼ˆæ¨¡å‹æ¶æ„ä¸å‚æ•°è®¾ç½®ï¼‰"><a href="#ğŸ“-2-yaml-â€”-æ¨¡å‹ç»“æ„é…ç½®æ–‡ä»¶ï¼ˆæ¨¡å‹æ¶æ„ä¸å‚æ•°è®¾ç½®ï¼‰" class="headerlink" title="ğŸ“ 2. *.yaml â€” æ¨¡å‹ç»“æ„é…ç½®æ–‡ä»¶ï¼ˆæ¨¡å‹æ¶æ„ä¸å‚æ•°è®¾ç½®ï¼‰"></a>ğŸ“ 2. <code>*.yaml</code> â€” æ¨¡å‹ç»“æ„é…ç½®æ–‡ä»¶ï¼ˆ<strong>æ¨¡å‹æ¶æ„ä¸å‚æ•°è®¾ç½®</strong>ï¼‰</h4><p>ä½ç½®ï¼š<code>models/</code> ç›®å½•ä¸‹ï¼Œå¸¸è§å¦‚ <code>yolov5s.yaml</code>ã€<code>yolov5m.yaml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># yolov5s.yaml ç¤ºä¾‹</span></span><br><span class="line"><span class="attr">nc:</span> <span class="number">80</span>  <span class="comment"># ç±»åˆ«æ•°ï¼Œä¼šåœ¨è®­ç»ƒæ—¶è¢« data.yaml ä¸­çš„ nc è¦†ç›–</span></span><br><span class="line"><span class="attr">depth_multiple:</span> <span class="number">0.33</span>  <span class="comment"># ç½‘ç»œæ·±åº¦ç³»æ•°ï¼ˆå±‚æ•°ç¼©æ”¾ï¼‰</span></span><br><span class="line"><span class="attr">width_multiple:</span> <span class="number">0.50</span>  <span class="comment"># é€šé“å®½åº¦ç³»æ•°ï¼ˆé€šé“æ•°ç¼©æ”¾ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="attr">anchors:</span></span><br><span class="line">  <span class="bullet">-</span> [<span class="number">10</span>,<span class="number">13</span>, <span class="number">16</span>,<span class="number">30</span>, <span class="number">33</span>,<span class="number">23</span>]  <span class="comment"># P3</span></span><br><span class="line">  <span class="bullet">-</span> [<span class="number">30</span>,<span class="number">61</span>, <span class="number">62</span>,<span class="number">45</span>, <span class="number">59</span>,<span class="number">119</span>] <span class="comment"># P4</span></span><br><span class="line">  <span class="bullet">-</span> [<span class="number">116</span>,<span class="number">90</span>, <span class="number">156</span>,<span class="number">198</span>, <span class="number">373</span>,<span class="number">326</span>] <span class="comment"># P5</span></span><br><span class="line"></span><br><span class="line"><span class="attr">backbone:</span></span><br><span class="line">  [[<span class="number">-1</span>, <span class="number">1</span>, <span class="string">Focus</span>, [<span class="number">64</span>, <span class="number">3</span>]],</span><br><span class="line">   [<span class="number">-1</span>, <span class="number">1</span>, <span class="string">Conv</span>, [<span class="number">128</span>, <span class="number">3</span>, <span class="number">2</span>]],</span><br><span class="line">   <span class="string">...</span>]</span><br><span class="line"></span><br><span class="line"><span class="attr">head:</span></span><br><span class="line">  [[<span class="number">-1</span>, <span class="number">1</span>, <span class="string">Detect</span>, [<span class="string">nc</span>, <span class="string">anchors</span>]]]</span><br></pre></td></tr></table></figure><blockquote><p>âœ… è®­ç»ƒæ—¶ï¼Œä½¿ç”¨çš„æ˜¯ä½ è‡ªå·±é€‰æ‹©çš„æ¨¡å‹ç»“æ„æ–‡ä»¶ï¼ˆé€šè¿‡ <code>--cfg</code> æˆ– <code>--weights</code> æ¨æ–­å‡ºï¼‰ã€‚</p></blockquote><hr><h4 id="âš™ï¸-3-hyp-yaml-â€”-è¶…å‚æ•°é…ç½®æ–‡ä»¶ï¼ˆå­¦ä¹ ç‡ã€å¢å¼ºã€æŸå¤±å‡½æ•°ç­‰è¶…å‚æ•°ï¼‰"><a href="#âš™ï¸-3-hyp-yaml-â€”-è¶…å‚æ•°é…ç½®æ–‡ä»¶ï¼ˆå­¦ä¹ ç‡ã€å¢å¼ºã€æŸå¤±å‡½æ•°ç­‰è¶…å‚æ•°ï¼‰" class="headerlink" title="âš™ï¸ 3. hyp.yaml â€” è¶…å‚æ•°é…ç½®æ–‡ä»¶ï¼ˆå­¦ä¹ ç‡ã€å¢å¼ºã€æŸå¤±å‡½æ•°ç­‰è¶…å‚æ•°ï¼‰"></a>âš™ï¸ 3. <code>hyp.yaml</code> â€” è¶…å‚æ•°é…ç½®æ–‡ä»¶ï¼ˆ<strong>å­¦ä¹ ç‡ã€å¢å¼ºã€æŸå¤±å‡½æ•°ç­‰è¶…å‚æ•°</strong>ï¼‰</h4><p>ä½ç½®ï¼šé»˜è®¤åœ¨ <code>data/hyps/</code> ç›®å½•ä¸‹ï¼Œå¦‚ <code>hyp.scratch-low.yaml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">lr0:</span> <span class="number">0.01</span>           <span class="comment"># åˆå§‹å­¦ä¹ ç‡</span></span><br><span class="line"><span class="attr">lrf:</span> <span class="number">0.01</span>           <span class="comment"># æœ€ç»ˆå­¦ä¹ ç‡ (final LR = lr0 * lrf)</span></span><br><span class="line"><span class="attr">momentum:</span> <span class="number">0.937</span>     <span class="comment"># SGDåŠ¨é‡</span></span><br><span class="line"><span class="attr">weight_decay:</span> <span class="number">0.0005</span></span><br><span class="line"><span class="attr">warmup_epochs:</span> <span class="number">3.0</span>  <span class="comment"># é¢„çƒ­è½®æ•°</span></span><br><span class="line"><span class="attr">hsv_h:</span> <span class="number">0.015</span>        <span class="comment"># è‰²è°ƒå¢å¼º</span></span><br><span class="line"><span class="attr">hsv_s:</span> <span class="number">0.7</span>          <span class="comment"># é¥±å’Œåº¦å¢å¼º</span></span><br><span class="line"><span class="attr">fl_gamma:</span> <span class="number">0.0</span>       <span class="comment"># Focal Loss gamma</span></span><br></pre></td></tr></table></figure><blockquote><p>ä½ å¯ä»¥é€šè¿‡ <code>--hyp</code> å‚æ•°æŒ‡å®šè¿™ä¸ªæ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python train.py --hyp data/hyps/hyp.scratch-low.yaml</span><br></pre></td></tr></table></figure></blockquote><hr><h4 id="âœ…-å°ç»“ï¼šä¸‰å¤§æ ¸å¿ƒé…ç½®æ–‡ä»¶è¯´æ˜è¡¨"><a href="#âœ…-å°ç»“ï¼šä¸‰å¤§æ ¸å¿ƒé…ç½®æ–‡ä»¶è¯´æ˜è¡¨" class="headerlink" title="âœ… å°ç»“ï¼šä¸‰å¤§æ ¸å¿ƒé…ç½®æ–‡ä»¶è¯´æ˜è¡¨"></a>âœ… å°ç»“ï¼šä¸‰å¤§æ ¸å¿ƒé…ç½®æ–‡ä»¶è¯´æ˜è¡¨</h4><div class="table-container"><table><thead><tr><th>é…ç½®æ–‡ä»¶</th><th>ä½œç”¨</th><th>å¸¸è§ä½ç½®</th></tr></thead><tbody><tr><td><code>data.yaml</code></td><td>æŒ‡å®šè®­ç»ƒ/éªŒè¯/æµ‹è¯•é›†å’Œç±»åˆ«ä¿¡æ¯</td><td>ä½ é¡¹ç›®ç›®å½• / <code>data/</code></td></tr><tr><td><code>*.yaml</code></td><td>å®šä¹‰æ¨¡å‹ç»“æ„ï¼ˆyolov5s ç­‰ï¼‰</td><td><code>models/</code></td></tr><tr><td><code>hyp.yaml</code></td><td>è®¾ç½®è®­ç»ƒè¶…å‚æ•°ï¼ˆå¢å¼ºã€LR ç­‰ï¼‰</td><td><code>data/hyps/</code></td></tr></tbody></table></div><hr><h2 id="æ¨¡å‹è®­ç»ƒ"><a href="#æ¨¡å‹è®­ç»ƒ" class="headerlink" title="æ¨¡å‹è®­ç»ƒ"></a>æ¨¡å‹è®­ç»ƒ</h2><h3 id="æ‰§è¡ŒæŒ‡ä»¤è¯´æ˜"><a href="#æ‰§è¡ŒæŒ‡ä»¤è¯´æ˜" class="headerlink" title="æ‰§è¡ŒæŒ‡ä»¤è¯´æ˜"></a>æ‰§è¡ŒæŒ‡ä»¤è¯´æ˜</h3><p>ä¸€èˆ¬è®­ç»ƒè¿è¡Œå‘½ä»¤è¡Œå‘½ä»¤ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python train.py --img 640 --batch 16 --epochs 50 --data wheat.yaml --weights yolov5s.pt --name wheat_yolov5</span><br></pre></td></tr></table></figure></p><hr><h4 id="ğŸ“‚-æ¨¡å‹ä¸æ•°æ®ç›¸å…³å‚æ•°"><a href="#ğŸ“‚-æ¨¡å‹ä¸æ•°æ®ç›¸å…³å‚æ•°" class="headerlink" title="ğŸ“‚ æ¨¡å‹ä¸æ•°æ®ç›¸å…³å‚æ•°"></a>ğŸ“‚ æ¨¡å‹ä¸æ•°æ®ç›¸å…³å‚æ•°</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--weights</code></td><td><code>str</code></td><td><code>yolov5s.pt</code></td><td>åˆå§‹æƒé‡è·¯å¾„ï¼Œå¯ä¸ºå®˜æ–¹æ¨¡å‹æˆ–è‡ªå®šä¹‰è®­ç»ƒçš„ <code>.pt</code> æ–‡ä»¶ã€‚</td></tr><tr><td><code>--cfg</code></td><td><code>str</code></td><td><code>&quot;&quot;</code></td><td>æ¨¡å‹ç»“æ„é…ç½®æ–‡ä»¶ï¼ˆå¦‚ <code>yolov5s.yaml</code>ï¼‰ã€‚ä¸ºç©ºåˆ™ä» <code>weights</code> æ¨æ–­ã€‚</td></tr><tr><td><code>--data</code></td><td><code>str</code></td><td><code>data/coco128.yaml</code></td><td>æ•°æ®é›†é…ç½®æ–‡ä»¶ï¼ŒåŒ…å« <code>train</code>, <code>val</code>, <code>nc</code>, <code>names</code> ç­‰å­—æ®µã€‚</td></tr><tr><td><code>--hyp</code></td><td><code>str</code></td><td><code>data/hyps/hyp.scratch-low.yaml</code></td><td>è¶…å‚æ•°é…ç½®æ–‡ä»¶ï¼ŒåŒ…æ‹¬å­¦ä¹ ç‡ã€IoUé˜ˆå€¼ã€æŸå¤±ç­‰ã€‚</td></tr></tbody></table></div><hr><h4 id="ğŸ“ˆ-è®­ç»ƒæ§åˆ¶å‚æ•°"><a href="#ğŸ“ˆ-è®­ç»ƒæ§åˆ¶å‚æ•°" class="headerlink" title="ğŸ“ˆ è®­ç»ƒæ§åˆ¶å‚æ•°"></a>ğŸ“ˆ è®­ç»ƒæ§åˆ¶å‚æ•°</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--epochs</code></td><td><code>int</code></td><td><code>100</code></td><td>è®­ç»ƒæ€»è½®æ•°ã€‚</td></tr><tr><td><code>--batch-size</code></td><td><code>int</code></td><td><code>16</code></td><td>æ‰¹å¤§å°ï¼Œæ‰€æœ‰GPUæ€»å’Œã€‚<code>-1</code> è¡¨ç¤ºè‡ªåŠ¨æ¨æ–­ã€‚</td></tr><tr><td><code>--imgsz</code> / <code>--img</code> / <code>--img-size</code></td><td><code>int</code></td><td><code>640</code></td><td>è¾“å…¥å›¾åƒå°ºå¯¸ï¼ˆä¼šç¼©æ”¾ä¸ºæ­£æ–¹å½¢ï¼‰ã€‚</td></tr><tr><td><code>--rect</code></td><td><code>store_true</code></td><td><code>False</code></td><td>æ˜¯å¦å¯ç”¨çŸ©å½¢è®­ç»ƒï¼ˆå›¾åƒæŒ‰é•¿å®½æ¯”ä¾‹åˆ†ç»„ï¼‰ã€‚</td></tr><tr><td><code>--multi-scale</code></td><td><code>store_true</code></td><td><code>False</code></td><td>æ˜¯å¦åœ¨è®­ç»ƒä¸­åŠ¨æ€æ”¹å˜å›¾åƒå¤§å°ï¼ˆÂ±50%ï¼‰ã€‚</td></tr><tr><td><code>--resume</code></td><td>å¯é€‰å‚æ•°</td><td><code>False</code></td><td>æ˜¯å¦ä»æœ€è¿‘çš„æ–­ç‚¹ç»§ç»­è®­ç»ƒã€‚</td></tr><tr><td><code>--freeze</code></td><td><code>List[int]</code></td><td><code>[0]</code></td><td>å†»ç»“ç½‘ç»œå±‚ï¼Œç¤ºä¾‹ï¼š<code>--freeze 0 1 2</code> è¡¨ç¤ºå†»ç»“å‰3å±‚ã€‚</td></tr><tr><td><code>--single-cls</code></td><td><code>store_true</code></td><td><code>False</code></td><td>æ˜¯å¦å°†æ‰€æœ‰ç±»åˆ«è§†ä¸ºä¸€ä¸ªç±»åˆ«ï¼ˆé€‚ç”¨äºå•ç±»æ•°æ®ï¼‰ã€‚</td></tr></tbody></table></div><hr><h4 id="ğŸ’¾-æ¨¡å‹ä¿å­˜ä¸éªŒè¯å‚æ•°"><a href="#ğŸ’¾-æ¨¡å‹ä¿å­˜ä¸éªŒè¯å‚æ•°" class="headerlink" title="ğŸ’¾ æ¨¡å‹ä¿å­˜ä¸éªŒè¯å‚æ•°"></a>ğŸ’¾ æ¨¡å‹ä¿å­˜ä¸éªŒè¯å‚æ•°</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--nosave</code></td><td><code>store_true</code></td><td><code>False</code></td><td>æ˜¯å¦åªä¿å­˜æœ€åä¸€ä¸ªæ¨¡å‹ï¼Œä¸ä¿å­˜ä¸­é—´checkpointã€‚</td></tr><tr><td><code>--noval</code></td><td><code>store_true</code></td><td><code>False</code></td><td>æ˜¯å¦ä»…åœ¨æœ€åä¸€ä¸ª epoch éªŒè¯æ¨¡å‹æ€§èƒ½ã€‚</td></tr><tr><td><code>--save-period</code></td><td><code>int</code></td><td><code>-1</code></td><td>æ¯é—´éš” x ä¸ª epoch ä¿å­˜ä¸€æ¬¡æ¨¡å‹ã€‚å°äº1è¡¨ç¤ºç¦ç”¨ã€‚</td></tr></tbody></table></div><hr><h4 id="ğŸ§ -è¶…å‚æ•°è¿›åŒ–ï¼ˆè¿›é˜¶åŠŸèƒ½ï¼‰"><a href="#ğŸ§ -è¶…å‚æ•°è¿›åŒ–ï¼ˆè¿›é˜¶åŠŸèƒ½ï¼‰" class="headerlink" title="ğŸ§  è¶…å‚æ•°è¿›åŒ–ï¼ˆè¿›é˜¶åŠŸèƒ½ï¼‰"></a>ğŸ§  è¶…å‚æ•°è¿›åŒ–ï¼ˆè¿›é˜¶åŠŸèƒ½ï¼‰</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--evolve</code></td><td><code>int</code></td><td>å¯é€‰ï¼Œé»˜è®¤<code>300</code></td><td>ä½¿ç”¨é—ä¼ ç®—æ³•è‡ªåŠ¨è¿›åŒ–è¶…å‚æ•°ï¼Œè¿è¡Œ <code>x</code> ä»£ã€‚</td></tr><tr><td><code>--evolve_population</code></td><td><code>str</code></td><td><code>data/hyps</code></td><td>è¿›åŒ–æ—¶åŠ è½½çš„åˆå§‹ç§ç¾¤è¶…å‚æ•°è·¯å¾„ã€‚</td></tr><tr><td><code>--resume_evolve</code></td><td><code>str</code></td><td><code>None</code></td><td>ä»å…ˆå‰è¿›åŒ–çš„æœ€åä¸€ä»£æ¢å¤ã€‚</td></tr></tbody></table></div><hr><h4 id="ğŸ§°-è¿è¡Œæ§åˆ¶å‚æ•°"><a href="#ğŸ§°-è¿è¡Œæ§åˆ¶å‚æ•°" class="headerlink" title="ğŸ§° è¿è¡Œæ§åˆ¶å‚æ•°"></a>ğŸ§° è¿è¡Œæ§åˆ¶å‚æ•°</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--device</code></td><td><code>str</code></td><td><code>&quot;&quot;</code></td><td>æŒ‡å®šè®¾å¤‡ï¼šå¦‚ <code>0</code>ã€<code>0,1</code> æˆ– <code>cpu</code>ã€‚</td></tr><tr><td><code>--optimizer</code></td><td><code>str</code></td><td><code>SGD</code></td><td>é€‰æ‹©ä¼˜åŒ–å™¨ï¼š<code>SGD</code>, <code>Adam</code>, <code>AdamW</code>ã€‚</td></tr><tr><td><code>--sync-bn</code></td><td><code>store_true</code></td><td><code>False</code></td><td>å¯ç”¨åŒæ­¥BatchNormï¼ˆä»… DDP æ¨¡å¼æœ‰æ•ˆï¼‰ã€‚</td></tr><tr><td><code>--quad</code></td><td><code>store_true</code></td><td><code>False</code></td><td>å¯ç”¨å››å…ƒåŠ è½½å™¨ä¼˜åŒ–ï¼ˆæŸäº›GPUåŠ é€Ÿï¼‰ã€‚</td></tr><tr><td><code>--cos-lr</code></td><td><code>store_true</code></td><td><code>False</code></td><td>ä½¿ç”¨ä½™å¼¦å­¦ä¹ ç‡è°ƒåº¦å™¨ã€‚</td></tr><tr><td><code>--label-smoothing</code></td><td><code>float</code></td><td><code>0.0</code></td><td>æ ‡ç­¾å¹³æ»‘å› å­ï¼ˆé˜²æ­¢è¿‡æ‹Ÿåˆï¼‰ã€‚</td></tr><tr><td><code>--patience</code></td><td><code>int</code></td><td><code>100</code></td><td>EarlyStoppingå®¹å¿çš„æ— æ”¹è¿›epochæ•°ã€‚</td></tr><tr><td><code>--seed</code></td><td><code>int</code></td><td><code>0</code></td><td>è®¾ç½®éšæœºç§å­ï¼Œç¡®ä¿ç»“æœå¯å¤ç°ã€‚</td></tr><tr><td><code>--workers</code></td><td><code>int</code></td><td><code>8</code></td><td>æ¯ä¸ªè¿›ç¨‹çš„æ•°æ®åŠ è½½çº¿ç¨‹æ•°ã€‚</td></tr><tr><td><code>--local_rank</code></td><td><code>int</code></td><td><code>-1</code></td><td>DDP å¤šGPUæ¨¡å¼ä¸‹è‡ªåŠ¨è®¾ç½®ï¼Œä¸è¦æ‰‹åŠ¨ä¿®æ”¹ã€‚</td></tr></tbody></table></div><hr><h4 id="ğŸ“-æ—¥å¿—è®°å½•ä¸ç»“æœä¿å­˜"><a href="#ğŸ“-æ—¥å¿—è®°å½•ä¸ç»“æœä¿å­˜" class="headerlink" title="ğŸ“ æ—¥å¿—è®°å½•ä¸ç»“æœä¿å­˜"></a>ğŸ“ æ—¥å¿—è®°å½•ä¸ç»“æœä¿å­˜</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--project</code></td><td><code>str</code></td><td><code>runs/train</code></td><td>ä¿å­˜è®­ç»ƒç»“æœçš„é¡¹ç›®ç›®å½•ã€‚</td></tr><tr><td><code>--name</code></td><td><code>str</code></td><td><code>exp</code></td><td>å­ç›®å½•åç§°ã€‚</td></tr><tr><td><code>--exist-ok</code></td><td><code>store_true</code></td><td><code>False</code></td><td>å¦‚æœç›®å½•å­˜åœ¨ï¼Œåˆ™ä¸è‡ªåŠ¨å¢åŠ ç¼–å·ã€‚</td></tr></tbody></table></div><hr><h4 id="â˜ï¸-äº‘ä¸ç¼“å­˜ç›¸å…³"><a href="#â˜ï¸-äº‘ä¸ç¼“å­˜ç›¸å…³" class="headerlink" title="â˜ï¸ äº‘ä¸ç¼“å­˜ç›¸å…³"></a>â˜ï¸ äº‘ä¸ç¼“å­˜ç›¸å…³</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--bucket</code></td><td><code>str</code></td><td><code>&quot;&quot;</code></td><td>ç”¨äº Google Cloud Storage çš„ gsutil bucket è·¯å¾„ã€‚</td></tr><tr><td><code>--cache</code></td><td><code>str</code></td><td>å¯é€‰</td><td><code>ram</code> æˆ– <code>disk</code>ï¼Œç¼“å­˜å›¾åƒåˆ°å†…å­˜æˆ–ç¡¬ç›˜ä»¥åŠ é€Ÿè®­ç»ƒã€‚</td></tr><tr><td><code>--image-weights</code></td><td><code>store_true</code></td><td><code>False</code></td><td>å›¾åƒé‡‡æ ·æ ¹æ®æƒé‡è¿›è¡Œï¼ˆæå‡å°‘æ•°ç±»æ ·æœ¬ï¼‰ã€‚</td></tr></tbody></table></div><hr><h4 id="ğŸ”—-W-amp-B-Artifact-æ—¥å¿—å‚æ•°ï¼ˆç”¨äºå®éªŒè¿½è¸ªï¼‰"><a href="#ğŸ”—-W-amp-B-Artifact-æ—¥å¿—å‚æ•°ï¼ˆç”¨äºå®éªŒè¿½è¸ªï¼‰" class="headerlink" title="ğŸ”— W\&amp;B / Artifact æ—¥å¿—å‚æ•°ï¼ˆç”¨äºå®éªŒè¿½è¸ªï¼‰"></a>ğŸ”— W\&amp;B / Artifact æ—¥å¿—å‚æ•°ï¼ˆç”¨äºå®éªŒè¿½è¸ªï¼‰</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--entity</code></td><td><code>str</code></td><td><code>None</code></td><td>W\&amp;B å®éªŒçš„å›¢é˜Ÿæˆ–ä¸ªäººå®ä½“åã€‚</td></tr><tr><td><code>--upload_dataset</code></td><td><code>store_true</code></td><td><code>False</code></td><td>æ˜¯å¦ä¸Šä¼ æ•°æ®é›†åˆ° W\&amp;Bã€‚å¯é€‰ <code>&quot;val&quot;</code>ã€‚</td></tr><tr><td><code>--bbox_interval</code></td><td><code>int</code></td><td><code>-1</code></td><td>æ—¥å¿—ä¸­æ˜¾ç¤ºæ£€æµ‹æ¡†å›¾ç‰‡çš„é—´éš” epochã€‚</td></tr><tr><td><code>--artifact_alias</code></td><td><code>str</code></td><td><code>&quot;latest&quot;</code></td><td>æŒ‡å®šä½¿ç”¨çš„ artifact ç‰ˆæœ¬æ ‡ç­¾ã€‚</td></tr></tbody></table></div><hr><h4 id="ğŸ§¾-NDJSON-æ—¥å¿—å‚æ•°ï¼ˆç»“æ„åŒ–æ—¥å¿—ï¼‰"><a href="#ğŸ§¾-NDJSON-æ—¥å¿—å‚æ•°ï¼ˆç»“æ„åŒ–æ—¥å¿—ï¼‰" class="headerlink" title="ğŸ§¾ NDJSON æ—¥å¿—å‚æ•°ï¼ˆç»“æ„åŒ–æ—¥å¿—ï¼‰"></a>ğŸ§¾ NDJSON æ—¥å¿—å‚æ•°ï¼ˆç»“æ„åŒ–æ—¥å¿—ï¼‰</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--ndjson-console</code></td><td><code>store_true</code></td><td><code>False</code></td><td>åœ¨æ§åˆ¶å°è¾“å‡º ndjson æ ¼å¼æ—¥å¿—ã€‚</td></tr><tr><td><code>--ndjson-file</code></td><td><code>store_true</code></td><td><code>False</code></td><td>å°† ndjson æ—¥å¿—è¾“å‡ºåˆ°æ–‡ä»¶ã€‚</td></tr></tbody></table></div><hr><h2 id="æ¨¡å‹æ¨ç†ä¸éªŒè¯"><a href="#æ¨¡å‹æ¨ç†ä¸éªŒè¯" class="headerlink" title="æ¨¡å‹æ¨ç†ä¸éªŒè¯"></a>æ¨¡å‹æ¨ç†ä¸éªŒè¯</h2><h3 id="æ‰§è¡ŒæŒ‡ä»¤è¯´æ˜-1"><a href="#æ‰§è¡ŒæŒ‡ä»¤è¯´æ˜-1" class="headerlink" title="æ‰§è¡ŒæŒ‡ä»¤è¯´æ˜"></a>æ‰§è¡ŒæŒ‡ä»¤è¯´æ˜</h3><p>ä¸€èˆ¬ç›®æ ‡æ£€æµ‹æ‰§è¡Œå‘½ä»¤ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python detect.py --weights runs/train/wheat_yolov5/weights/best.pt --source /test_image_folder --img 640 --conf 0.25 --save-txt --save-conf --project runs/predict --name wheat_test</span><br></pre></td></tr></table></figure></p><h4 id="ğŸ¯-æ ¸å¿ƒæ¨ç†å‚æ•°"><a href="#ğŸ¯-æ ¸å¿ƒæ¨ç†å‚æ•°" class="headerlink" title="ğŸ¯ æ ¸å¿ƒæ¨ç†å‚æ•°"></a>ğŸ¯ æ ¸å¿ƒæ¨ç†å‚æ•°</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--weights</code></td><td><code>str/list[str]</code></td><td><code>yolov5s.pt</code></td><td>æ¨¡å‹è·¯å¾„ï¼ˆ<code>.pt</code> æ–‡ä»¶ï¼‰ï¼Œä¹Ÿå¯ä¸ºå¤šä¸ªæ¨¡å‹æˆ– Triton æœåŠ¡å™¨åœ°å€ã€‚</td></tr><tr><td><code>--source</code></td><td><code>str</code></td><td><code>data/images</code></td><td>è¾“å…¥æ¥æºï¼šæ–‡ä»¶ã€æ–‡ä»¶å¤¹ã€URLã€globã€æ‘„åƒå¤´ï¼ˆå¦‚ <code>0</code>ï¼‰æˆ– <code>screen</code>ã€‚</td></tr><tr><td><code>--data</code></td><td><code>str</code></td><td><code>data/coco128.yaml</code></td><td>æ•°æ®é›†é…ç½®æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰ã€‚ç”¨äºåŠ è½½ç±»åˆ«åç­‰ä¿¡æ¯ã€‚</td></tr><tr><td><code>--imgsz</code> / <code>--img</code> / <code>--img-size</code></td><td><code>list[int]</code></td><td><code>[640]</code></td><td>æ¨ç†å›¾åƒçš„å°ºå¯¸ï¼Œå•ä¸ªå€¼æˆ– <code>[h, w]</code>ã€‚å¦‚æœåªç»™ä¸€ä¸ªï¼Œåˆ™ä¼šæ‰©å±•æˆ <code>[640, 640]</code>ã€‚</td></tr><tr><td><code>--conf-thres</code></td><td><code>float</code></td><td><code>0.25</code></td><td>ç½®ä¿¡åº¦é˜ˆå€¼ï¼Œä½äºè¯¥å€¼çš„æ£€æµ‹æ¡†ä¼šè¢«è¿‡æ»¤ã€‚</td></tr><tr><td><code>--iou-thres</code></td><td><code>float</code></td><td><code>0.45</code></td><td>éæå¤§å€¼æŠ‘åˆ¶ï¼ˆNMSï¼‰ä¸­çš„ IoU é˜ˆå€¼ã€‚</td></tr><tr><td><code>--max-det</code></td><td><code>int</code></td><td><code>1000</code></td><td>æ¯å¼ å›¾ç‰‡æœ€å¤šä¿ç•™çš„ç›®æ ‡æ£€æµ‹æ•°é‡ã€‚</td></tr><tr><td><code>--device</code></td><td><code>str</code></td><td><code>&quot;&quot;</code></td><td>è®¡ç®—è®¾å¤‡ï¼Œå¦‚ <code>&#39;0&#39;</code>, <code>&#39;0,1&#39;</code>, <code>&#39;cpu&#39;</code> ç­‰ã€‚</td></tr></tbody></table></div><hr><h4 id="ğŸ–¼ï¸-å¯è§†åŒ–ä¸ä¿å­˜é€‰é¡¹"><a href="#ğŸ–¼ï¸-å¯è§†åŒ–ä¸ä¿å­˜é€‰é¡¹" class="headerlink" title="ğŸ–¼ï¸ å¯è§†åŒ–ä¸ä¿å­˜é€‰é¡¹"></a>ğŸ–¼ï¸ å¯è§†åŒ–ä¸ä¿å­˜é€‰é¡¹</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--view-img</code></td><td><code>bool</code></td><td><code>False</code></td><td>æ˜¯å¦æ˜¾ç¤ºæ£€æµ‹ç»“æœå›¾åƒï¼ˆæœ¬åœ°çª—å£ï¼‰ã€‚</td></tr><tr><td><code>--save-txt</code></td><td><code>bool</code></td><td><code>False</code></td><td>æ˜¯å¦å°†æ£€æµ‹ç»“æœä¿å­˜ä¸º <code>.txt</code> æ–‡ä»¶ï¼ˆYOLOæ ¼å¼æˆ–Pascal VOCæ ¼å¼ï¼‰ã€‚</td></tr><tr><td><code>--save-format</code></td><td><code>int</code></td><td><code>0</code></td><td>é…åˆ <code>--save-txt</code>ï¼š<code>0</code> ä¸º YOLO æ ¼å¼ï¼Œ<code>1</code> ä¸º Pascal VOC æ ¼å¼ã€‚</td></tr><tr><td><code>--save-csv</code></td><td><code>bool</code></td><td><code>False</code></td><td>æ˜¯å¦å°†ç»“æœä¿å­˜ä¸º <code>.csv</code> æ–‡ä»¶ã€‚</td></tr><tr><td><code>--save-conf</code></td><td><code>bool</code></td><td><code>False</code></td><td>æ˜¯å¦å°†ç½®ä¿¡åº¦ä¸€åŒä¿å­˜åˆ° <code>.txt</code> æ–‡ä»¶ä¸­ã€‚</td></tr><tr><td><code>--save-crop</code></td><td><code>bool</code></td><td><code>False</code></td><td>æ˜¯å¦ä¿å­˜æ¯ä¸ªæ£€æµ‹æ¡†è£å‰ªå‡ºçš„ç›®æ ‡å›¾åƒã€‚</td></tr><tr><td><code>--nosave</code></td><td><code>bool</code></td><td><code>False</code></td><td>ä¸ä¿å­˜ä»»ä½•å›¾åƒæˆ–è§†é¢‘ç»“æœï¼Œä»…åœ¨æ§åˆ¶å°è¾“å‡ºã€‚</td></tr><tr><td><code>--project</code></td><td><code>str</code></td><td><code>runs/detect</code></td><td>ç»“æœä¿å­˜æ ¹ç›®å½•ã€‚</td></tr><tr><td><code>--name</code></td><td><code>str</code></td><td><code>exp</code></td><td>å­ç›®å½•åç§°ã€‚</td></tr><tr><td><code>--exist-ok</code></td><td><code>bool</code></td><td><code>False</code></td><td>å¦‚æœç›®å½•å·²å­˜åœ¨ï¼Œä¸è‡ªåŠ¨åˆ›å»º <code>exp2</code>, <code>exp3</code>ï¼Œè€Œæ˜¯ç›´æ¥è¦†ç›–æˆ–é‡ç”¨ã€‚</td></tr><tr><td><code>--line-thickness</code></td><td><code>int</code></td><td><code>3</code></td><td>æ£€æµ‹æ¡†çš„çº¿å®½ï¼ˆåƒç´ ï¼‰ã€‚</td></tr><tr><td><code>--hide-labels</code></td><td><code>bool</code></td><td><code>False</code></td><td>ä¸åœ¨å›¾åƒä¸Šæ˜¾ç¤ºç±»åˆ«æ ‡ç­¾ã€‚</td></tr><tr><td><code>--hide-conf</code></td><td><code>bool</code></td><td><code>False</code></td><td>ä¸åœ¨å›¾åƒä¸Šæ˜¾ç¤ºç½®ä¿¡åº¦åˆ†æ•°ã€‚</td></tr></tbody></table></div><hr><h4 id="ğŸ“Š-æ£€æµ‹æ§åˆ¶é€‰é¡¹"><a href="#ğŸ“Š-æ£€æµ‹æ§åˆ¶é€‰é¡¹" class="headerlink" title="ğŸ“Š æ£€æµ‹æ§åˆ¶é€‰é¡¹"></a>ğŸ“Š æ£€æµ‹æ§åˆ¶é€‰é¡¹</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--classes</code></td><td><code>list[int]</code></td><td><code>None</code></td><td>ä»…æ£€æµ‹æŒ‡å®šç±»åˆ«ï¼Œä¾‹å¦‚ <code>--classes 0 2 3</code>ã€‚</td></tr><tr><td><code>--agnostic-nms</code></td><td><code>bool</code></td><td><code>False</code></td><td>ä½¿ç”¨ç±»åˆ«æ— å…³çš„ NMSï¼ˆæ‰€æœ‰ç±»åˆ«å…±ç”¨æŠ‘åˆ¶é€»è¾‘ï¼‰ã€‚</td></tr><tr><td><code>--augment</code></td><td><code>bool</code></td><td><code>False</code></td><td>å¯ç”¨æ•°æ®å¢å¼ºçš„æ¨ç†ï¼ˆç•¥æ…¢ä½†å¯èƒ½æ›´é²æ£’ï¼‰ã€‚</td></tr><tr><td><code>--visualize</code></td><td><code>bool</code></td><td><code>False</code></td><td>å¯è§†åŒ–ä¸­é—´ç‰¹å¾å›¾ï¼ˆéœ€æ¨¡å‹æ”¯æŒï¼‰ã€‚</td></tr><tr><td><code>--update</code></td><td><code>bool</code></td><td><code>False</code></td><td>è‡ªåŠ¨æ›´æ–°æ¨¡å‹ï¼ˆè½¬æ¢æ—§æ ¼å¼ä¸ºæ–°æ ¼å¼ï¼‰ã€‚</td></tr><tr><td><code>--half</code></td><td><code>bool</code></td><td><code>False</code></td><td>ä½¿ç”¨åŠç²¾åº¦ï¼ˆFP16ï¼‰æ¨ç†ï¼Œä»…é™äº <code>CUDA</code>ã€‚</td></tr><tr><td><code>--dnn</code></td><td><code>bool</code></td><td><code>False</code></td><td>ä½¿ç”¨ OpenCV DNN æ¨¡å¼è¿›è¡Œ ONNX æ¨ç†ã€‚</td></tr><tr><td><code>--vid-stride</code></td><td><code>int</code></td><td><code>1</code></td><td>è§†é¢‘æ¨ç†æ—¶çš„å¸§è·³è·ƒé—´éš”ï¼Œä¾‹å¦‚ <code>--vid-stride 5</code> è¡¨ç¤ºæ¯5å¸§å¤„ç†ä¸€å¸§ã€‚</td></tr></tbody></table></div><hr><h4 id="âœ…-ç¤ºä¾‹å‘½ä»¤"><a href="#âœ…-ç¤ºä¾‹å‘½ä»¤" class="headerlink" title="âœ… ç¤ºä¾‹å‘½ä»¤"></a>âœ… ç¤ºä¾‹å‘½ä»¤</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ£€æµ‹å•å¼ å›¾ç‰‡å¹¶ä¿å­˜ç»“æœ</span></span><br><span class="line">python detect.py --weights yolov5s.pt --<span class="built_in">source</span> ./data/images/zidane.jpg --conf-thres 0.3 --save-txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»…æ£€æµ‹ç±»åˆ« 0 å’Œ 2ï¼Œæ˜¾ç¤ºç»“æœä½†ä¸ä¿å­˜å›¾åƒ</span></span><br><span class="line">python detect.py --weights yolov5s.pt --<span class="built_in">source</span> ./data/images --classes 0 2 --view-img --nosave</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¹è§†é¢‘æ¨ç†ï¼Œæ¯5å¸§æ£€æµ‹ä¸€æ¬¡ï¼Œä¿å­˜æ£€æµ‹æ¡†ä¸º Pascal VOC æ ¼å¼</span></span><br><span class="line">python detect.py --weights yolov5s.pt --<span class="built_in">source</span> video.mp4 --vid-stride 5 --save-txt --save-format 1</span><br></pre></td></tr></table></figure><h2 id="æ¨¡å‹å¯¼å‡ºä¸éƒ¨ç½²"><a href="#æ¨¡å‹å¯¼å‡ºä¸éƒ¨ç½²" class="headerlink" title="æ¨¡å‹å¯¼å‡ºä¸éƒ¨ç½²"></a>æ¨¡å‹å¯¼å‡ºä¸éƒ¨ç½²</h2><h3 id="æ‰§è¡ŒæŒ‡ä»¤è¯´æ˜-2"><a href="#æ‰§è¡ŒæŒ‡ä»¤è¯´æ˜-2" class="headerlink" title="æ‰§è¡ŒæŒ‡ä»¤è¯´æ˜"></a>æ‰§è¡ŒæŒ‡ä»¤è¯´æ˜</h3><p>ä»¥ä¸‹æ˜¯å¯¹æ¯ä¸ªå‘½ä»¤è¡Œå‚æ•°çš„è¯¦ç»†è§£é‡Šï¼š</p><hr><h4 id="ğŸ—‚ï¸-æ•°æ®å’Œæ¨¡å‹è·¯å¾„é…ç½®"><a href="#ğŸ—‚ï¸-æ•°æ®å’Œæ¨¡å‹è·¯å¾„é…ç½®" class="headerlink" title="ğŸ—‚ï¸ æ•°æ®å’Œæ¨¡å‹è·¯å¾„é…ç½®"></a>ğŸ—‚ï¸ æ•°æ®å’Œæ¨¡å‹è·¯å¾„é…ç½®</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--data</code></td><td>str</td><td><code>data/coco128.yaml</code></td><td>æ•°æ®é›†é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œä¸»è¦ç”¨äºè·å–ç±»åˆ«æ•°ç­‰ä¿¡æ¯</td></tr><tr><td><code>--weights</code></td><td>str/list</td><td><code>yolov5s.pt</code></td><td>è®­ç»ƒå¥½çš„æ¨¡å‹æƒé‡è·¯å¾„ï¼Œæ”¯æŒå¤šä¸ªæ¨¡å‹åŒæ—¶å¯¼å‡º</td></tr><tr><td><code>--imgsz</code> / <code>--img</code> / <code>--img-size</code></td><td>int list</td><td><code>[640, 640]</code></td><td>è¾“å…¥å›¾ç‰‡å°ºå¯¸ <code>[height, width]</code>ï¼Œé»˜è®¤æ˜¯æ­£æ–¹å½¢</td></tr><tr><td><code>--batch-size</code></td><td>int</td><td>1</td><td>æ¨ç†æ—¶çš„ batch sizeï¼Œä¸€èˆ¬ä¿æŒä¸º1ä»¥é˜²ä¸å…¼å®¹</td></tr></tbody></table></div><hr><h4 id="âš™ï¸-è®¾å¤‡å’Œæ¨ç†ç²¾åº¦"><a href="#âš™ï¸-è®¾å¤‡å’Œæ¨ç†ç²¾åº¦" class="headerlink" title="âš™ï¸ è®¾å¤‡å’Œæ¨ç†ç²¾åº¦"></a>âš™ï¸ è®¾å¤‡å’Œæ¨ç†ç²¾åº¦</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--device</code></td><td>str</td><td><code>cpu</code></td><td>è¿è¡Œå¯¼å‡ºè¿‡ç¨‹æ‰€ä½¿ç”¨çš„è®¾å¤‡ï¼Œå¦‚ <code>0</code>, <code>cpu</code>, <code>0,1</code> ç­‰</td></tr><tr><td><code>--half</code></td><td>flag</td><td>False</td><td>æ˜¯å¦ä½¿ç”¨ FP16 ç²¾åº¦å¯¼å‡ºï¼ˆä»…é™æ”¯æŒçš„å¹³å°ï¼‰</td></tr></tbody></table></div><hr><h4 id="âš™ï¸-å¯¼å‡ºè¡Œä¸ºæ§åˆ¶"><a href="#âš™ï¸-å¯¼å‡ºè¡Œä¸ºæ§åˆ¶" class="headerlink" title="âš™ï¸ å¯¼å‡ºè¡Œä¸ºæ§åˆ¶"></a>âš™ï¸ å¯¼å‡ºè¡Œä¸ºæ§åˆ¶</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--inplace</code></td><td>flag</td><td>False</td><td>æ˜¯å¦å°† Detect() çš„ <code>inplace=True</code>ï¼Œå½±å“æ¨¡å‹è¾“å‡ºå¼ é‡çš„ä¿®æ”¹æ–¹å¼</td></tr><tr><td><code>--keras</code></td><td>flag</td><td>False</td><td>TensorFlow å¯¼å‡ºæ—¶æ˜¯å¦ä½¿ç”¨ Keras æ¨¡å¼ï¼ˆ<code>.h5</code>ï¼‰</td></tr><tr><td><code>--optimize</code></td><td>flag</td><td>False</td><td>TorchScript ä¼˜åŒ–ç”¨äºç§»åŠ¨ç«¯éƒ¨ç½²ï¼ˆä¼šåº”ç”¨ graph ä¼˜åŒ–ï¼‰</td></tr></tbody></table></div><hr><h4 id="ğŸ¯-é‡åŒ–å’ŒåŠ¨æ€è½´æ§åˆ¶"><a href="#ğŸ¯-é‡åŒ–å’ŒåŠ¨æ€è½´æ§åˆ¶" class="headerlink" title="ğŸ¯ é‡åŒ–å’ŒåŠ¨æ€è½´æ§åˆ¶"></a>ğŸ¯ é‡åŒ–å’ŒåŠ¨æ€è½´æ§åˆ¶</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--int8</code></td><td>flag</td><td>False</td><td>å¯¼å‡º INT8 é‡åŒ–æ¨¡å‹ï¼ˆæ”¯æŒ TFã€CoreMLã€OpenVINOï¼‰</td></tr><tr><td><code>--per-tensor</code></td><td>flag</td><td>False</td><td>TensorFlow çš„ per-tensor é‡åŒ–æ–¹å¼ï¼ˆé»˜è®¤æ˜¯ per-channelï¼‰</td></tr><tr><td><code>--dynamic</code></td><td>flag</td><td>False</td><td>å¯ç”¨åŠ¨æ€è¾“å…¥å°ºå¯¸ï¼ˆæ”¯æŒ ONNXã€TFã€TensorRTï¼‰</td></tr></tbody></table></div><hr><h4 id="ğŸ§ -ONNX-ç›¸å…³"><a href="#ğŸ§ -ONNX-ç›¸å…³" class="headerlink" title="ğŸ§  ONNX ç›¸å…³"></a>ğŸ§  ONNX ç›¸å…³</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--simplify</code></td><td>flag</td><td>False</td><td>ç®€åŒ– ONNX æ¨¡å‹å›¾ï¼ˆéœ€å®‰è£… <code>onnxsim</code>ï¼‰</td></tr><tr><td><code>--opset</code></td><td>int</td><td>17</td><td>ONNX çš„ opset ç‰ˆæœ¬ï¼Œå¸¸è§ä¸º 11~17</td></tr></tbody></table></div><hr><h4 id="ğŸ§ -TensorRT-ç›¸å…³"><a href="#ğŸ§ -TensorRT-ç›¸å…³" class="headerlink" title="ğŸ§  TensorRT ç›¸å…³"></a>ğŸ§  TensorRT ç›¸å…³</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--engine</code>ï¼ˆç”± <code>--include engine</code> æ§åˆ¶ï¼‰</td><td></td><td></td><td>TensorRT å¯¼å‡ºå¼€å…³</td></tr><tr><td><code>--cache</code></td><td>str</td><td>â€œâ€</td><td>TensorRT çš„æ—¶é—´ cache æ–‡ä»¶è·¯å¾„ï¼ˆåŠ é€Ÿç¼–è¯‘ï¼‰</td></tr><tr><td><code>--workspace</code></td><td>int</td><td>4</td><td>TensorRT æœ€å¤§ workspace å¤§å°ï¼ˆå•ä½ GBï¼‰</td></tr><tr><td><code>--verbose</code></td><td>flag</td><td>False</td><td>TensorRT å¯¼å‡ºæ—¶æ˜¯å¦æ‰“å°è¯¦ç»†æ—¥å¿—</td></tr></tbody></table></div><hr><h4 id="ğŸ-CoreML-ç›¸å…³"><a href="#ğŸ-CoreML-ç›¸å…³" class="headerlink" title="ğŸ CoreML ç›¸å…³"></a>ğŸ CoreML ç›¸å…³</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--mlmodel</code></td><td>flag</td><td>False</td><td>å¯¼å‡º CoreML <code>.mlmodel</code> æ ¼å¼</td></tr><tr><td><code>--int8</code></td><td>flag</td><td>False</td><td>å¯é…åˆç”¨äºé‡åŒ– CoreML</td></tr></tbody></table></div><hr><h4 id="ğŸ§ª-TensorFlow-jsï¼ˆTF-jsï¼‰ç›¸å…³ï¼ˆç”¨äº-Web-ç«¯ï¼‰"><a href="#ğŸ§ª-TensorFlow-jsï¼ˆTF-jsï¼‰ç›¸å…³ï¼ˆç”¨äº-Web-ç«¯ï¼‰" class="headerlink" title="ğŸ§ª TensorFlow.jsï¼ˆTF.jsï¼‰ç›¸å…³ï¼ˆç”¨äº Web ç«¯ï¼‰"></a>ğŸ§ª TensorFlow.jsï¼ˆTF.jsï¼‰ç›¸å…³ï¼ˆç”¨äº Web ç«¯ï¼‰</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--nms</code></td><td>flag</td><td>False</td><td>æ·»åŠ éæå¤§æŠ‘åˆ¶ NMSï¼ˆé»˜è®¤æ¨¡å‹ä¸­ä¸åŒ…å«ï¼‰</td></tr><tr><td><code>--agnostic-nms</code></td><td>flag</td><td>False</td><td>ç±»åˆ«æ— å…³çš„ NMS</td></tr><tr><td><code>--topk-per-class</code></td><td>int</td><td>100</td><td>æ¯ä¸ªç±»åˆ«ä¿ç•™å‰ K ä¸ªæ£€æµ‹ç»“æœ</td></tr><tr><td><code>--topk-all</code></td><td>int</td><td>100</td><td>æ‰€æœ‰ç±»åˆ«ä¸€å…±ä¿ç•™å‰ K ä¸ªæ£€æµ‹ç»“æœ</td></tr><tr><td><code>--iou-thres</code></td><td>float</td><td>0.45</td><td>NMS çš„ IoU é˜ˆå€¼</td></tr><tr><td><code>--conf-thres</code></td><td>float</td><td>0.25</td><td>ç½®ä¿¡åº¦é˜ˆå€¼ï¼Œä½äºæ­¤å€¼çš„æ¡†ä¼šè¢«ä¸¢å¼ƒ</td></tr></tbody></table></div><hr><h4 id="ğŸ¯-å¯¼å‡ºæ ¼å¼è®¾ç½®ï¼ˆæ ¸å¿ƒå‚æ•°ï¼‰"><a href="#ğŸ¯-å¯¼å‡ºæ ¼å¼è®¾ç½®ï¼ˆæ ¸å¿ƒå‚æ•°ï¼‰" class="headerlink" title="ğŸ¯ å¯¼å‡ºæ ¼å¼è®¾ç½®ï¼ˆæ ¸å¿ƒå‚æ•°ï¼‰"></a>ğŸ¯ å¯¼å‡ºæ ¼å¼è®¾ç½®ï¼ˆæ ¸å¿ƒå‚æ•°ï¼‰</h4><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--include</code></td><td>list</td><td><code>[&#39;torchscript&#39;]</code></td><td>è¦å¯¼å‡ºçš„æ ¼å¼ï¼Œå¯ä»¥åŒ…å«å¤šä¸ªï¼š<br> <code>torchscript</code>, <code>onnx</code>, <code>openvino</code>, <code>engine</code>, <code>coreml</code>, <code>saved_model</code>, <code>pb</code>, <code>tflite</code>, <code>edgetpu</code>, <code>tfjs</code>, <code>paddle</code> ç­‰</td></tr></tbody></table></div><hr><h3 id="âœ…-ç¤ºä¾‹ç”¨æ³•"><a href="#âœ…-ç¤ºä¾‹ç”¨æ³•" class="headerlink" title="âœ… ç¤ºä¾‹ç”¨æ³•"></a>âœ… ç¤ºä¾‹ç”¨æ³•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯¼å‡º ONNX + TorchScript + TensorRT å¼•æ“ï¼ˆä½¿ç”¨ GPUï¼‰</span></span><br><span class="line">python export.py \</span><br><span class="line">  --weights yolov5s.pt \</span><br><span class="line">  --img 640 \</span><br><span class="line">  --device 0 \</span><br><span class="line">  --include onnx torchscript engine \</span><br><span class="line">  --dynamic \</span><br><span class="line">  --simplify \</span><br><span class="line">  --opset 17</span><br></pre></td></tr></table></figure><hr><p>PSï¼šå°é¢å›¾æ¥æºï¼š<a href="https://x.com/nakiriayame/status/1946478772301213900?s=46"><br>ç™¾é¬¼ã‚ã‚„ã‚ğŸ˜ˆãƒ›ãƒ­ãƒ©ã‚¤ãƒ–2æœŸç”Ÿ</a></p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;YOLOv5ä½¿ç”¨æ–¹æ³•&quot;&gt;&lt;a href=&quot;#YOLOv5ä½¿ç”¨æ–¹æ³•&quot; class=&quot;headerlink&quot; title=&quot;YOLOv5ä½¿ç”¨æ–¹æ³•&quot;&gt;&lt;/a&gt;YOLOv5ä½¿ç”¨æ–¹æ³•&lt;/h1&gt;&lt;h2 id=&quot;æ•°æ®é›†&quot;&gt;&lt;a href=&quot;#æ•°æ®é›†&quot;</summary>
        
      
    
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://blog.whff521.xyz/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="yolo" scheme="https://blog.whff521.xyz/tags/yolo/"/>
    
  </entry>
  
  <entry>
    <title>Kaggle:  CIFAR-10-Object Recognition in Images</title>
    <link href="https://blog.whff521.xyz/2025/07/19/Kaggle-CIFAR-10-Object-Recognition-in-Images/"/>
    <id>https://blog.whff521.xyz/2025/07/19/Kaggle-CIFAR-10-Object-Recognition-in-Images/</id>
    <published>2025-07-19T02:14:45.000Z</published>
    <updated>2025-07-19T06:42:29.826Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Kaggle-CIFAR-10-Object-Recognition-in-Images"><a href="#Kaggle-CIFAR-10-Object-Recognition-in-Images" class="headerlink" title="Kaggle:  CIFAR-10-Object Recognition in Images"></a>Kaggle:  CIFAR-10-Object Recognition in Images</h1><p>æœ¬æ–‡æ˜¯å®ç°<code>d2l</code>ç½‘ç«™ä»£ç çš„æ€»ç»“ï¼Œ<a href="https://zh.d2l.ai/chapter_computer-vision/kaggle-cifar10.html#fig-kaggle-cifar10">æ•™ç¨‹é“¾æ¥</a></p><p>æœ¬æ–‡æ‰€ç”¨ç¯å¢ƒå¦‚ä¸‹ï¼š<br><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python==3.9.23</span><br><span class="line">nvidia-cuda-runtime-cu12==12.9.79</span><br><span class="line">torch==2.7.1+cu118</span><br><span class="line">d2l==1.0.3</span><br></pre></td></tr></table></figure></p><h2 id="ğŸ“š-æ•°æ®é›†ä»‹ç»"><a href="#ğŸ“š-æ•°æ®é›†ä»‹ç»" class="headerlink" title="ğŸ“š æ•°æ®é›†ä»‹ç»"></a>ğŸ“š æ•°æ®é›†ä»‹ç»</h2><p>CIFAR-10 æ˜¯ç”±åŠ æ‹¿å¤§å¤šä¼¦å¤šå¤§å­¦ Alex Krizhevsky ç­‰äººæ”¶é›†çš„å›¾åƒæ•°æ®é›†ï¼ŒåŒ…å«äº† <strong>10 ä¸ªç±»åˆ«çš„å½©è‰²å›¾ç‰‡</strong>ã€‚è¿™äº›å›¾ç‰‡éƒ½æ˜¯ä»çœŸå®ä¸–ç•Œæ‹æ‘„çš„ç‰©ä½“ä¸­è£å‰ªè€Œæ¥çš„ã€‚</p><h3 id="ğŸ“-æ•°æ®ç»†èŠ‚ï¼š"><a href="#ğŸ“-æ•°æ®ç»†èŠ‚ï¼š" class="headerlink" title="ğŸ“ æ•°æ®ç»†èŠ‚ï¼š"></a>ğŸ“ æ•°æ®ç»†èŠ‚ï¼š</h3><div class="table-container"><table><thead><tr><th>é¡¹ç›®</th><th>æè¿°</th></tr></thead><tbody><tr><td>å›¾ç‰‡å¤§å°</td><td>32x32 åƒç´ ï¼ŒRGBï¼ˆä¸‰é€šé“ï¼‰</td></tr><tr><td>å›¾ç‰‡æ•°é‡</td><td>60,000 å¼ å›¾åƒ</td></tr><tr><td>ç±»åˆ«æ•°é‡</td><td>10 ä¸ª</td></tr><tr><td>è®­ç»ƒé›†</td><td>50,000 å¼ å›¾åƒ</td></tr><tr><td>æµ‹è¯•é›†</td><td>10,000 å¼ å›¾åƒ</td></tr><tr><td>å›¾åƒæ ¼å¼</td><td><code>.png</code> å›¾åƒ + <code>.csv</code> æ ‡ç­¾/é¢„æµ‹</td></tr></tbody></table></div><h2 id="é¢„æµ‹æµç¨‹"><a href="#é¢„æµ‹æµç¨‹" class="headerlink" title="é¢„æµ‹æµç¨‹"></a>é¢„æµ‹æµç¨‹</h2><h3 id="å¯¼åŒ…"><a href="#å¯¼åŒ…" class="headerlink" title="å¯¼åŒ…"></a>å¯¼åŒ…</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> d2l <span class="keyword">import</span> torch <span class="keyword">as</span> d2l</span><br></pre></td></tr></table></figure><h3 id="æ•°æ®æ•´ç†"><a href="#æ•°æ®æ•´ç†" class="headerlink" title="æ•°æ®æ•´ç†"></a>æ•°æ®æ•´ç†</h3><p>æˆ‘æ˜¯å°†å®Œæ•´çš„æ•°æ®é›†ä¸‹è½½åˆ°æœ¬åœ°ç„¶åç›´æ¥ç”¨å…¨éƒ¨æ•°æ®è¿›è¡Œè®­ç»ƒçš„ã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®æ•°æ®é›†çš„å­˜å‚¨ä½ç½®</span></span><br><span class="line">data_dir = <span class="string">&#x27;D:\datasets\cifar-10&#x27;</span> </span><br></pre></td></tr></table></figure><p>æ–‡ä»¶å¤¹ä¸­æœ‰<code>trainLabels.csv</code>,é‡Œè¾¹æœ‰<code>id</code>å’Œ<code>label</code>ä¸¤åˆ—ï¼Œåˆ†åˆ«ä»£è¡¨å›¾ç‰‡åç§°å’Œæ ‡ç­¾ã€‚</p><p>åŸæ•™ç¨‹æ˜¯ç›´æ¥è¯»å–çš„æ–‡ä»¶ï¼Œæ ¹æ®csvæ–‡ä»¶æ˜¯ç”¨é€—å·åˆ†éš”å°†æ–‡ä»¶æ‹†æˆä¸¤éƒ¨åˆ†ç„¶åè½¬æ¢æˆå­—å…¸ç±»å‹ï¼Œå®é™…ä¸Šç›´æ¥ç”¨<code>pandas</code>åº“å°±å¯ä»¥ç›´æ¥è¯»å–ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">read_csv_labels</span>(<span class="params">fname</span>):</span><br><span class="line">    df = pd.read_csv(fname)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">dict</span>(<span class="built_in">zip</span>(df[<span class="string">&#x27;id&#x27;</span>], df[<span class="string">&#x27;label&#x27;</span>]))</span><br><span class="line"></span><br><span class="line">labels = read_csv_labels(os.path.join(data_dir,<span class="string">&#x27;trainLabels.csv&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;# training examples:&#x27;</span>, <span class="built_in">len</span>(labels))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;# classes:&#x27;</span>, <span class="built_in">len</span>(<span class="built_in">set</span>(labels.values())))</span><br></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†æ ‡ç­¾å­—å…¸ï¼Œå¯ä»¥ç›´æ¥ç”¨<code>labels</code>æŸ¥çœ‹å›¾ç‰‡çš„æ ‡ç­¾ã€‚</p><p>æ•™ç¨‹ä¸­ä¸ºäº†æ–¹ä¾¿è¯»å–å›¾ç‰‡ï¼Œå°†å›¾ç‰‡çš„å­˜å‚¨ä½ç½®é‡æ–°æ•´ç†äº†ä¸€ä¸‹ï¼Œå»ºç«‹<code>train_valid_test</code>æ–‡ä»¶å¤¹ï¼Œé‡Œé¢æœ‰<code>train</code>,<code>valid</code>,<code>test</code>å’Œ<code>train_valid</code>å››ä¸ªæ–‡ä»¶å¤¹ã€‚é™¤äº†<code>test</code>æ–‡ä»¶å¤¹ï¼Œå…¶ä»–æ–‡ä»¶å¤¹å†…å‡æŒ‰ç…§æ ‡ç­¾åˆ†æˆ10ä¸ªæ–‡ä»¶å¤¹ï¼Œæ¯ä¸ªå›¾ç‰‡æ ¹æ®è‡ªå·±çš„æ ‡ç­¾æ”¾åˆ°ç›¸åº”çš„æ–‡ä»¶å¤¹é‡Œï¼Œè¿™æ ·åšæ˜¯ä¸ºäº†åé¢åˆ†ç»„çš„æ—¶å€™æ¯ç»„çš„æ ‡ç­¾å°½é‡å‡åŒ€ã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">copyfile</span>(<span class="params">filename, target_dir</span>):</span><br><span class="line">    os.makedirs(target_dir,exist_ok=<span class="literal">True</span>)</span><br><span class="line">    shutil.copy(filename,target_dir)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reorg_train_valid</span>(<span class="params">data_dir, labels, valid_ratio</span>):</span><br><span class="line">    <span class="comment"># The number of examples of the class that has the fewest examples in the</span></span><br><span class="line">    <span class="comment"># training dataset</span></span><br><span class="line">    n = collections.Counter(labels.values()).most_common()[-<span class="number">1</span>][<span class="number">1</span>]</span><br><span class="line">    n_valid_per_label = <span class="built_in">max</span>(<span class="number">1</span>,math.floor(n * valid_ratio))</span><br><span class="line">    label_count=&#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> train_file <span class="keyword">in</span> os.listdir(os.path.join(data_dir,<span class="string">&#x27;train&#x27;</span>)):</span><br><span class="line">        label = labels[train_file.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]]</span><br><span class="line">        fname = os.path.join(data_dir,<span class="string">&#x27;train&#x27;</span>,train_file)</span><br><span class="line">        copyfile(fname,os.path.join(data_dir,<span class="string">&#x27;train_valid_test&#x27;</span>,<span class="string">&#x27;train_valid&#x27;</span>,label))</span><br><span class="line">        <span class="keyword">if</span> label <span class="keyword">not</span> <span class="keyword">in</span> label_count <span class="keyword">or</span> label_count[label] &lt;n_valid_per_label:</span><br><span class="line">            copyfile(fname, os.path.join(data_dir,<span class="string">&#x27;train_valid_test&#x27;</span>,<span class="string">&#x27;valid&#x27;</span>,label))</span><br><span class="line">            label_count[label] = label_count.get(label,<span class="number">0</span>) + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            copyfile(fname, os.path.join(data_dir, <span class="string">&#x27;train_valid_test&#x27;</span>,<span class="string">&#x27;train&#x27;</span>,label))</span><br><span class="line">    <span class="keyword">return</span> n_valid_per_label</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reorg_test</span>(<span class="params">data_dir</span>):</span><br><span class="line">    <span class="keyword">for</span> test_file <span class="keyword">in</span> os.listdir(os.path.join(data_dir,<span class="string">&#x27;test&#x27;</span>)):</span><br><span class="line">        copyfile(os.path.join(data_dir, <span class="string">&#x27;test&#x27;</span>, test_file),</span><br><span class="line">                 os.path.join(data_dir,<span class="string">&#x27;train_valid_test&#x27;</span>,<span class="string">&#x27;test&#x27;</span>,<span class="string">&#x27;unknown&#x27;</span>))</span><br></pre></td></tr></table></figure><p><code>valid_ratio</code>ï¼šéªŒè¯é›†å æ¯”ï¼Œå¦‚0.1è¡¨ç¤ºéªŒè¯é›†500å¼ ï¼Œè®­ç»ƒé›†4500å¼ </p><p>ç„¶åå®šä¹‰ä¸€ä¸ªæ•´åˆå‡½æ•°ï¼Œå°†ä¸Šé¢çš„å‡½æ•°æµç¨‹ç»Ÿä¸€å¤„ç†ï¼š<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">reorg_cifar10_data</span>(<span class="params">data_dir,valid_ratio</span>):</span><br><span class="line">    labels = read_csv_labels(os.path.join(data_dir, <span class="string">&#x27;trainLabels.csv&#x27;</span>))</span><br><span class="line">    reorg_train_valid(data_dir, labels, valid_ratio)</span><br><span class="line">    reorg_test(data_dir)</span><br></pre></td></tr></table></figure></p><p>è®¾ç½®æ‰¹é‡å¤§å°ä¸º128ï¼Œå°†10ï¼…çš„è®­ç»ƒæ ·æœ¬ä½œä¸ºè°ƒæ•´è¶…å‚æ•°çš„éªŒè¯é›†</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">batch_size = <span class="number">128</span></span><br><span class="line">valid_ratio = <span class="number">0.1</span></span><br><span class="line">reorg_cifar10_data(data_dir,valid_ratio)</span><br></pre></td></tr></table></figure><h3 id="å›¾åƒå¢å¹¿"><a href="#å›¾åƒå¢å¹¿" class="headerlink" title="å›¾åƒå¢å¹¿"></a>å›¾åƒå¢å¹¿</h3><p>ä¸ºäº†é˜²æ­¢è¿‡æ‹Ÿåˆï¼Œä¸€èˆ¬ä¼šé‡‡ç”¨å›¾åƒå¢å¹¿ã€‚</p><p>æ ‡å‡†åŒ–çš„åŸå› ï¼š</p><ol><li>åŠ å¿«æ¨¡å‹æ”¶æ•›é€Ÿåº¦ã€‚è®©ç‰¹å¾å€¼èŒƒå›´å¤§è‡´åˆ†å¸ƒåœ¨[-1,1]</li><li>é¿å…æŸäº›ç‰¹å¾ä¸»å¯¼æ¨¡å‹è®­ç»ƒã€‚è®©å„é€šé“å‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º1ï¼Œå¹³è¡¡æ¯ä¸ªåƒç´ çš„â€œæƒé‡â€</li><li>æé«˜æ¨¡å‹æ³›åŒ–èƒ½åŠ›</li></ol><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">transform_train = torchvision.transforms.Compose([</span><br><span class="line">    <span class="comment"># åœ¨é«˜åº¦å’Œå®½åº¦ä¸Šå°†å›¾åƒæ”¾å¤§åˆ°40åƒç´ çš„æ­£æ–¹å½¢</span></span><br><span class="line">    torchvision.transforms.Resize(<span class="number">40</span>),</span><br><span class="line">    <span class="comment"># éšæœºè£å‰ªå‡ºä¸€ä¸ªé«˜åº¦å’Œå®½åº¦å‡ä¸º40åƒç´ çš„æ­£æ–¹å½¢å›¾åƒï¼Œ</span></span><br><span class="line">    <span class="comment"># ç”Ÿæˆä¸€ä¸ªé¢ç§¯ä¸ºåŸå§‹å›¾åƒé¢ç§¯0.64ï½1å€çš„å°æ­£æ–¹å½¢ï¼Œ</span></span><br><span class="line">    <span class="comment"># ç„¶åå°†å…¶ç¼©æ”¾ä¸ºé«˜åº¦å’Œå®½åº¦å‡ä¸º32åƒç´ çš„æ­£æ–¹å½¢</span></span><br><span class="line">    torchvision.transforms.RandomResizedCrop(<span class="number">32</span>, scale=(<span class="number">0.64</span>, <span class="number">1.0</span>),</span><br><span class="line">                                                   ratio=(<span class="number">1.0</span>, <span class="number">1.0</span>)),</span><br><span class="line">    <span class="comment"># éšæœºæ°´å¹³ç¿»è½¬</span></span><br><span class="line">    torchvision.transforms.RandomHorizontalFlip(),</span><br><span class="line">    torchvision.transforms.ToTensor(),</span><br><span class="line">    <span class="comment"># æ ‡å‡†åŒ–å›¾åƒçš„æ¯ä¸ªé€šé“</span></span><br><span class="line">    <span class="comment"># æ•°å­—æ˜¯æ ¹æ®æ•°æ®é›†æå‰è®¡ç®—çš„ï¼Œå‰é¢æ˜¯RGBå‡å€¼ï¼Œåè¾¹æ˜¯æ ‡å‡†å·®</span></span><br><span class="line">    torchvision.transforms.Normalize([<span class="number">0.4914</span>, <span class="number">0.4822</span>, <span class="number">0.4465</span>],</span><br><span class="line">                                     [<span class="number">0.2023</span>, <span class="number">0.1994</span>, <span class="number">0.2010</span>])])</span><br><span class="line"><span class="comment"># æµ‹è¯•åªæ‰§è¡Œæ ‡å‡†åŒ–</span></span><br><span class="line">transform_test = torchvision.transforms.Compose([</span><br><span class="line">    torchvision.transforms.ToTensor(),</span><br><span class="line">    torchvision.transforms.Normalize([<span class="number">0.4914</span>, <span class="number">0.4822</span>, <span class="number">0.4465</span>],</span><br><span class="line">                                     [<span class="number">0.2023</span>, <span class="number">0.1994</span>, <span class="number">0.2010</span>])])</span><br></pre></td></tr></table></figure><h3 id="è¯»å–æ•°æ®"><a href="#è¯»å–æ•°æ®" class="headerlink" title="è¯»å–æ•°æ®"></a>è¯»å–æ•°æ®</h3><p>å››ä¸ªdatasetåˆ—è¡¨ï¼šè®­ç»ƒé›†ï¼Œè®­ç»ƒéªŒè¯é›†ï¼ŒéªŒè¯é›†ï¼Œæµ‹è¯•é›†</p><p>ä½¿ç”¨è®­ç»ƒé›†å’ŒéªŒè¯é›†ç»„åˆè€Œæˆçš„æ•°æ®é›†ï¼ˆè®­ç»ƒéªŒè¯é›†ï¼‰è¿›è¡Œè®­ç»ƒï¼Œå……åˆ†åˆ©ç”¨æ‰€æœ‰æ ‡è®°çš„æ•°æ®ã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”¨åˆ—è¡¨æ¨å¯¼å¼ç®€æ´åœ°åŠ è½½ä¸¤ä¸ªä¸åŒå­ç›®å½•çš„å›¾åƒæ•°æ®é›†ï¼Œå¹¶åº”ç”¨åŒæ ·çš„å›¾åƒå¢å¼º transform_train</span></span><br><span class="line">train_ds, train_valid_ds = [torchvision.datasets.ImageFolder(</span><br><span class="line">    os.path.join(data_dir,<span class="string">&#x27;train_valid_test&#x27;</span>,folder),</span><br><span class="line">    transform=transform_train</span><br><span class="line">) <span class="keyword">for</span> folder <span class="keyword">in</span> [<span class="string">&#x27;train&#x27;</span>,<span class="string">&#x27;train_valid&#x27;</span>]]</span><br><span class="line"></span><br><span class="line">valid_ds, test_ds = [torchvision.datasets.ImageFolder(</span><br><span class="line">    os.path.join(data_dir,<span class="string">&#x27;train_valid_test&#x27;</span>,folder),</span><br><span class="line">    transform=transform_test</span><br><span class="line">) <span class="keyword">for</span> folder <span class="keyword">in</span> [<span class="string">&#x27;valid&#x27;</span>,<span class="string">&#x27;test&#x27;</span>]]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;train_ds size:&quot;</span>, <span class="built_in">len</span>(train_ds))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;train_valid_ds size:&quot;</span>, <span class="built_in">len</span>(train_valid_ds))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;valid_ds size:&quot;</span>, <span class="built_in">len</span>(valid_ds))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;test_ds size:&quot;</span>, <span class="built_in">len</span>(test_ds))</span><br></pre></td></tr></table></figure><p>è¿˜éœ€è¦å°†ä¸Šé¢çš„æ•°æ®é›†è½¬æ¢ä¸ºå¯è¿­ä»£çš„å¯¹è±¡ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”¨ DataLoader åˆ›å»ºäº†è®­ç»ƒã€éªŒè¯ã€æµ‹è¯•ç”¨çš„æ•°æ®è¿­ä»£å™¨ï¼Œåˆ†åˆ«æ§åˆ¶æ˜¯å¦æ‰“ä¹±é¡ºåºã€æ˜¯å¦ä¸¢å¼ƒæœ€åä¸è¶³ä¸€æ‰¹çš„æ•°æ®</span></span><br><span class="line">train_iter, train_valid_iter = [torch.utils.data.DataLoader(</span><br><span class="line">    dataset, batch_size, shuffle=<span class="literal">True</span>, drop_last=<span class="literal">True</span></span><br><span class="line">) <span class="keyword">for</span> dataset <span class="keyword">in</span> (train_ds, train_valid_ds)]</span><br><span class="line"></span><br><span class="line">valid_iter = torch.utils.data.DataLoader(valid_ds, batch_size,shuffle=<span class="literal">False</span>, drop_last=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">test_iter = torch.utils.data.DataLoader(test_ds, batch_size, shuffle=<span class="literal">False</span>,drop_last=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><h3 id="å®šä¹‰æ¨¡å‹"><a href="#å®šä¹‰æ¨¡å‹" class="headerlink" title="å®šä¹‰æ¨¡å‹"></a>å®šä¹‰æ¨¡å‹</h3><p>ä½¿ç”¨<code>Resnet-18</code>æ¨¡å‹</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_net</span>():</span><br><span class="line">    <span class="comment"># æ•°æ®é›†ä¸€å…±æœ‰10ä¸ªç±»åˆ«</span></span><br><span class="line">    num_classes = <span class="number">10</span></span><br><span class="line">    <span class="comment"># 3 æŒ‡RGB 3ä¸ªé€šé“æ•°</span></span><br><span class="line">    net = d2l.resnet18(num_classes, <span class="number">3</span>)</span><br><span class="line">    <span class="keyword">return</span> net</span><br><span class="line"><span class="comment"># äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼Œnoneè¡¨ç¤ºä¸è‡ªåŠ¨æ±‚å¹³å‡æˆ–æ±‚å’Œï¼Œè¿”å›çš„æ˜¯æ¯ä¸ªæ ·æœ¬çš„loss</span></span><br><span class="line">loss = nn.CrossEntropyLoss(reduction=<span class="string">&quot;none&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="å®šä¹‰è®­ç»ƒå‡½æ•°"><a href="#å®šä¹‰è®­ç»ƒå‡½æ•°" class="headerlink" title="å®šä¹‰è®­ç»ƒå‡½æ•°"></a>å®šä¹‰è®­ç»ƒå‡½æ•°</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">train</span>(<span class="params">net,</span></span><br><span class="line"><span class="params">          train_iter,</span></span><br><span class="line"><span class="params">          valid_iter,</span></span><br><span class="line"><span class="params">          num_epochs,</span></span><br><span class="line"><span class="params">          lr,</span></span><br><span class="line"><span class="params">          wd,</span></span><br><span class="line"><span class="params">          devices,</span></span><br><span class="line"><span class="params">          lr_period,</span></span><br><span class="line"><span class="params">          lr_decay</span>):</span><br><span class="line">    <span class="comment"># å®šä¹‰ä¼˜åŒ–å™¨ï¼šä½¿ç”¨å¸¦åŠ¨é‡çš„SGDä¼˜åŒ–å™¨ï¼ŒåŒ…å«å­¦ä¹ ç‡å’Œæƒé‡è¡°å‡</span></span><br><span class="line">    trainer = torch.optim.SGD(net.parameters(), lr=lr, momentum=<span class="number">0.9</span>, weight_decay=wd)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å­¦ä¹ ç‡è°ƒåº¦å™¨ï¼šæ¯éš” lr_period ä¸ª epochï¼Œå°†å­¦ä¹ ç‡ä¹˜ä»¥ lr_decay</span></span><br><span class="line">    scheduler = torch.optim.lr_scheduler.StepLR(trainer, lr_period, lr_decay)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è·å–è®­ç»ƒé›†çš„æ‰¹æ¬¡æ•°é‡ï¼Œåˆå§‹åŒ–è®¡æ—¶å™¨</span></span><br><span class="line">    num_batches, timer = <span class="built_in">len</span>(train_iter), d2l.Timer()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è®¾ç½®ç»˜å›¾å›¾ä¾‹</span></span><br><span class="line">    legend = [<span class="string">&#x27;train loss&#x27;</span>, <span class="string">&#x27;train acc&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> valid_iter <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        legend.append(<span class="string">&#x27;valid acc&#x27;</span>)  <span class="comment"># å¦‚æœæœ‰éªŒè¯é›†ï¼Œåˆ™åŠ ä¸ŠéªŒè¯å‡†ç¡®ç‡</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># åŠ¨ç”»å™¨ï¼šç”¨äºå¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹ï¼ˆæŸå¤±å’Œå‡†ç¡®ç‡ï¼‰</span></span><br><span class="line">    animator = d2l.Animator(xlabel=<span class="string">&#x27;epoch&#x27;</span>, xlim=[<span class="number">1</span>, num_epochs], legend=legend)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä½¿ç”¨å¤šGPUè®­ç»ƒï¼Œå°†æ¨¡å‹åŒ…è£…ä¸º DataParallel å¹¶ç§»åŠ¨åˆ°æŒ‡å®šè®¾å¤‡ä¸Š</span></span><br><span class="line">    net = nn.DataParallel(net, device_ids=devices).to(devices[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epochs):</span><br><span class="line">        net.train()  <span class="comment"># è®¾ç½®æ¨¡å‹ä¸ºè®­ç»ƒæ¨¡å¼</span></span><br><span class="line">        metric = d2l.Accumulator(<span class="number">3</span>)  <span class="comment"># ç´¯åŠ å™¨ï¼šè®°å½•è®­ç»ƒæŸå¤±ã€è®­ç»ƒå‡†ç¡®ç‡ã€æ ·æœ¬æ•°é‡</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i, (features, labels) <span class="keyword">in</span> <span class="built_in">enumerate</span>(train_iter):</span><br><span class="line">            timer.start()  <span class="comment"># å¼€å§‹è®¡æ—¶</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># å•ä¸ª batch çš„è®­ç»ƒï¼Œè¿”å›æŸå¤±å’Œå‡†ç¡®ç‡</span></span><br><span class="line">            l, acc = d2l.train_batch_ch13(net, features, labels, loss, trainer, devices)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># ç´¯åŠ æŸå¤±ã€å‡†ç¡®ç‡ã€æ ·æœ¬æ•°</span></span><br><span class="line">            metric.add(l, acc, labels.shape[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">            timer.stop()  <span class="comment"># åœæ­¢è®¡æ—¶</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># æ¯è®­ç»ƒ 1/5 çš„ batch æˆ–æœ€åä¸€ä¸ª batch æ—¶æ›´æ–°å›¾åƒ</span></span><br><span class="line">            <span class="keyword">if</span> (i + <span class="number">1</span>) % (num_batches // <span class="number">5</span>) == <span class="number">0</span> <span class="keyword">or</span> i == num_batches - <span class="number">1</span>:</span><br><span class="line">                animator.add(epoch + (i+<span class="number">1</span>) / num_batches,</span><br><span class="line">                             (metric[<span class="number">0</span>] / metric[<span class="number">2</span>],  <span class="comment"># å¹³å‡è®­ç»ƒæŸå¤±</span></span><br><span class="line">                              metric[<span class="number">1</span>] / metric[<span class="number">2</span>],  <span class="comment"># å¹³å‡è®­ç»ƒå‡†ç¡®ç‡</span></span><br><span class="line">                              <span class="literal">None</span>))  <span class="comment"># æš‚æ—¶ä¸æ›´æ–°éªŒè¯å‡†ç¡®ç‡</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¦‚æœæœ‰éªŒè¯é›†ï¼Œåœ¨æ¯ä¸ª epoch ç»“æŸåè¯„ä¼°éªŒè¯å‡†ç¡®ç‡å¹¶å¯è§†åŒ–</span></span><br><span class="line">        <span class="keyword">if</span> valid_iter <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            valid_acc = d2l.evaluate_accuracy_gpu(net, valid_iter)</span><br><span class="line">            animator.add(epoch + <span class="number">1</span>, (<span class="literal">None</span>, <span class="literal">None</span>, valid_acc))  <span class="comment"># åªæ›´æ–°éªŒè¯å‡†ç¡®ç‡</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ›´æ–°å­¦ä¹ ç‡ï¼ˆæ ¹æ®å­¦ä¹ ç‡è°ƒåº¦å™¨ï¼‰</span></span><br><span class="line">        scheduler.step()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ‰“å°æœ€ç»ˆçš„è®­ç»ƒæŒ‡æ ‡</span></span><br><span class="line">    measures = (<span class="string">f&#x27;train loss <span class="subst">&#123;metric[<span class="number">0</span>] / metric[<span class="number">2</span>]:<span class="number">.3</span>f&#125;</span>, &#x27;</span></span><br><span class="line">                <span class="string">f&#x27;train acc <span class="subst">&#123;metric[<span class="number">1</span>] / metric[<span class="number">2</span>]:<span class="number">.3</span>f&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> valid_iter <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        measures += <span class="string">f&#x27;, valid acc <span class="subst">&#123;valid_acc:<span class="number">.3</span>f&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ‰“å°è®­ç»ƒé€Ÿåº¦å’Œè®¾å¤‡ä¿¡æ¯</span></span><br><span class="line">    <span class="built_in">print</span>(measures + <span class="string">f&#x27;\n<span class="subst">&#123;metric[<span class="number">2</span>] * num_epochs / timer.<span class="built_in">sum</span>():<span class="number">.1</span>f&#125;</span>&#x27;</span></span><br><span class="line">          <span class="string">f&#x27; examples/sec on <span class="subst">&#123;<span class="built_in">str</span>(devices)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è®­ç»ƒå’ŒéªŒè¯æ¨¡å‹"><a href="#è®­ç»ƒå’ŒéªŒè¯æ¨¡å‹" class="headerlink" title="è®­ç»ƒå’ŒéªŒè¯æ¨¡å‹"></a>è®­ç»ƒå’ŒéªŒè¯æ¨¡å‹</h3><p>å®šä¹‰è¶…å‚æ•°å’Œè®­ç»ƒæ¨¡å‹</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">devices, num_epochs, lr, wd = d2l.try_all_gpus(), <span class="number">20</span>, <span class="number">2e-4</span>, <span class="number">5e-4</span></span><br><span class="line">lr_period, lr_decay, net = <span class="number">4</span>, <span class="number">0.9</span>, get_net()</span><br><span class="line">train(net, train_iter, valid_iter, num_epochs, lr, wd, devices, lr_period,</span><br><span class="line">      lr_decay)</span><br></pre></td></tr></table></figure><h3 id="å¯¹æµ‹è¯•é›†è¿›è¡Œåˆ†ç±»å¹¶ç”Ÿæˆç»“æœ"><a href="#å¯¹æµ‹è¯•é›†è¿›è¡Œåˆ†ç±»å¹¶ç”Ÿæˆç»“æœ" class="headerlink" title="å¯¹æµ‹è¯•é›†è¿›è¡Œåˆ†ç±»å¹¶ç”Ÿæˆç»“æœ"></a>å¯¹æµ‹è¯•é›†è¿›è¡Œåˆ†ç±»å¹¶ç”Ÿæˆç»“æœ</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">net, preds = get_net(), []</span><br><span class="line">train(net, train_valid_iter, <span class="literal">None</span>, num_epochs, lr, wd, devices, lr_period,</span><br><span class="line">      lr_decay)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> X, _ <span class="keyword">in</span> test_iter:</span><br><span class="line">    y_hat = net(X.to(devices[<span class="number">0</span>]))</span><br><span class="line">    preds.extend(y_hat.argmax(dim=<span class="number">1</span>).<span class="built_in">type</span>(torch.int32).cpu().numpy())</span><br><span class="line">sorted_ids = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(test_ds) + <span class="number">1</span>))</span><br><span class="line">sorted_ids.sort(key=<span class="keyword">lambda</span> x: <span class="built_in">str</span>(x))</span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;id&#x27;</span>: sorted_ids, <span class="string">&#x27;label&#x27;</span>: preds&#125;)</span><br><span class="line">df[<span class="string">&#x27;label&#x27;</span>] = df[<span class="string">&#x27;label&#x27;</span>].apply(<span class="keyword">lambda</span> x: train_valid_ds.classes[x])</span><br><span class="line">df.to_csv(<span class="string">&#x27;submission.csv&#x27;</span>, index=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆçš„<code>submission.csv</code>å°±å¯ä»¥æäº¤åˆ°Kaggleä¸Šäº†ã€‚</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;Kaggle-CIFAR-10-Object-Recognition-in-Images&quot;&gt;&lt;a href=&quot;#Kaggle-CIFAR-10-Object-Recognition-in-Images&quot; class=&quot;headerlink&quot;</summary>
        
      
    
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://blog.whff521.xyz/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="Pytorch" scheme="https://blog.whff521.xyz/tags/Pytorch/"/>
    
  </entry>
  
  <entry>
    <title>antfuçš„è–…ç‰›æ¯›åœ°å›¾çš„è‡ªç”¨æ–¹æ³•</title>
    <link href="https://blog.whff521.xyz/2025/07/14/antfu%E7%9A%84%E8%96%85%E7%89%9B%E6%AF%9B%E5%9C%B0%E5%9B%BE%E7%9A%84%E8%87%AA%E7%94%A8%E6%96%B9%E6%B3%95/"/>
    <id>https://blog.whff521.xyz/2025/07/14/antfu%E7%9A%84%E8%96%85%E7%89%9B%E6%AF%9B%E5%9C%B0%E5%9B%BE%E7%9A%84%E8%87%AA%E7%94%A8%E6%96%B9%E6%B3%95/</id>
    <published>2025-07-14T08:47:56.000Z</published>
    <updated>2025-07-22T07:12:58.101Z</updated>
    
    <content type="html"><![CDATA[<h1 id="antfuçš„è–…ç‰›æ¯›åœ°å›¾çš„è‡ªç”¨æ–¹æ³•"><a href="#antfuçš„è–…ç‰›æ¯›åœ°å›¾çš„è‡ªç”¨æ–¹æ³•" class="headerlink" title="antfuçš„è–…ç‰›æ¯›åœ°å›¾çš„è‡ªç”¨æ–¹æ³•"></a>antfuçš„è–…ç‰›æ¯›åœ°å›¾çš„è‡ªç”¨æ–¹æ³•</h1><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>å»å¹´çœ‹äº†Anthony Fuçš„â€œè–…ç‰›æ¯›â€æ¼”è®²ï¼Œå½“æ—¶çœ‹åˆ°ppté‡Œå¯†é›†çš„è·¯çº¿å›¾ç€å®æ˜¯è¢«è§†è§‰å†²å‡»äº†ã€‚å°†å¤æ‚çš„å­¦ä¹ è·¯çº¿é€šè¿‡è·¯çº¿å›¾ä¸€ä¸ªä¸ªè¡¨ç¤ºå‡ºæ¥ï¼Œæœ€åæ•´ä½“å»ä¿¯ç°ï¼Œç«Ÿæœ‰ä¸€ç§å®ä¼Ÿçš„æˆå°±æ„Ÿã€‚</p><p>ä»€ä¹ˆæ˜¯è–…ç‰›æ¯›å‘¢ï¼Ÿåœ¨æˆ‘çš„ç°çŠ¶ä¸‹ï¼Œåœ¨å­¦ä¹ æ–°ä¸œè¥¿æˆ–è€…å®Œæˆä»»åŠ¡çš„æ—¶å€™ï¼Œéš¾å…ä¼šæœ‰ä¸€äº›â€œå‰ç½®çŸ¥è¯†â€éœ€è¦å»äº†è§£ï¼Œç„¶åè¦ç†è§£â€œå‰ç½®çŸ¥è¯†â€çš„è¯ï¼Œè¿˜éœ€è¦å­¦ä¹ ä¸€ä¸‹â€œå‰ç½®çŸ¥è¯†â€çš„â€œå‰ç½®çŸ¥è¯†â€ã€‚è¿™å¯èƒ½ä¼šå˜æˆä¸€ç§dfsæˆ–è€…bfsï¼Œè¶Šå­¦è¶Šå¤šï¼Œè¶Šå­¦è¶Šè¿œï¼Œå¯èƒ½æœ‰ä¸€å¤©å‘ç°è‡ªå·±åœ¨è‰åŸä¸Šè–…ç‰›æ¯›ï¼Œè€Œä¸€å¼€å§‹çš„ç›®æ ‡å’Œè–…ç‰›æ¯›æ²¡æœ‰ä¸€ç‚¹ç‚¹å…³è”ã€‚</p><p>æœ€è¿‘æ­£åœ¨å­¦ä¹ å›¾åƒè¯†åˆ«çš„å†…å®¹ï¼Œæœ€ä¸»è¦çš„ç›®æ ‡å°±æ˜¯å­¦ä¼šä½¿ç”¨YOLOv5ã€‚å½“ç„¶ä»…ä»…æ˜¯ä½¿ç”¨çš„è¯å¾ˆç®€å•ï¼Œæˆ‘éœ€è¦çš„æ˜¯äº†è§£å…¶ä¸­çš„åŸç†å¹¶ä½¿ç”¨å®ƒã€‚ä¹Ÿå› æ­¤æˆ‘çš„â€œè–…ç‰›æ¯›â€ä¹‹æ—…å¼€å§‹äº†ã€‚</p><h2 id="åˆ¶ä½œæ–¹æ³•"><a href="#åˆ¶ä½œæ–¹æ³•" class="headerlink" title="åˆ¶ä½œæ–¹æ³•"></a>åˆ¶ä½œæ–¹æ³•</h2><h3 id="ä¸‹è½½ä»£ç "><a href="#ä¸‹è½½ä»£ç " class="headerlink" title="ä¸‹è½½ä»£ç "></a>ä¸‹è½½ä»£ç </h3><p>æˆ‘ä»¬å¯ä»¥å…ˆforkä¸€ä¸‹Anthony Fuçš„<a href="https://github.com/antfu/yak-shaving-map">ä»“åº“ä»£ç </a>ã€‚</p><h3 id="å®‰è£…ç¯å¢ƒ"><a href="#å®‰è£…ç¯å¢ƒ" class="headerlink" title="å®‰è£…ç¯å¢ƒ"></a>å®‰è£…ç¯å¢ƒ</h3><p>ç„¶åå°†è‡ªå·±ä»“åº“çš„ä»£ç ä¸‹è½½åˆ°æœ¬åœ°ï¼Œå…ˆå®‰è£…ç¯å¢ƒï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¦‚æœæœ¬åœ°æ²¡æœ‰pnpmè¦å…ˆä¸‹è½½pnpmï¼Œä»€ä¹ˆï¼Ÿè¿npméƒ½æ²¡æœ‰ï¼Ÿ</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é‚£å¯ä»¥â€œè–…ç‰›æ¯›â€äº†ğŸ˜‚</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">npm install -g pnpm</span></span><br><span class="line">pnpm install</span><br></pre></td></tr></table></figure><p>è¿è¡Œä»£ç åªéœ€è¦è¿è¡Œï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm run dev</span><br></pre></td></tr></table></figure></p><h3 id="ä¿®æ”¹ä»£ç "><a href="#ä¿®æ”¹ä»£ç " class="headerlink" title="ä¿®æ”¹ä»£ç "></a>ä¿®æ”¹ä»£ç </h3><p>å…¶ä¸­<code>data.ts</code>ä¸­å­˜å‚¨çš„æ˜¯èŠ‚ç‚¹çš„ä¸Šä¸‹çº§å…³ç³»ä»¥åŠèŠ‚ç‚¹å½¢çŠ¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ é™¤åŸæ¥çš„èŠ‚ç‚¹ï¼Œå¡«å†™è‡ªå·±æƒ³è¦çš„èŠ‚ç‚¹ã€‚</p><p><code>yak-map-pos.json</code>é‡Œè¾¹æ˜¯èŠ‚ç‚¹çš„åæ ‡ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸éœ€è¦æ‰‹åŠ¨æ›´æ”¹ï¼Œè¿è¡Œé¡¹ç›®åä½¿ç”¨é¼ æ ‡å¯ä»¥æ‹–åŠ¨èŠ‚ç‚¹ä½ç½®ï¼Œä¼šè‡ªåŠ¨æ·»åŠ å½“å‰èŠ‚ç‚¹åˆ°jsonä¸­ï¼Œjsonä¸­çš„èŠ‚ç‚¹åæ ‡ä¼šè‡ªåŠ¨å˜åŒ–ã€‚<strong>å»ºè®®å…ˆæŠŠè¿™é‡Œé¢çš„æ‰€æœ‰èŠ‚ç‚¹åˆ é™¤å†æ·»åŠ ç¼–å†™<code>data.ts</code>ã€‚</strong></p><p>å…¶ä¸­èŠ‚ç‚¹ç±»ä¼¼ä¸‹é¢ä»£ç ï¼š<br><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;YOLOv4&#x27;</span>,</span><br><span class="line">  <span class="attr">display</span>: <span class="string">&#x27;YOLOv4&#x27;</span>,</span><br><span class="line">  <span class="attr">link</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">shape</span>: <span class="string">&#x27;circle&#x27;</span>,</span><br><span class="line">  <span class="attr">color</span>: colors.<span class="property">YOLOv4</span>,</span><br><span class="line">  <span class="attr">from</span>: [<span class="string">&#x27;yolov5&#x27;</span>],</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;CSPDarknet53&#x27;</span>,</span><br><span class="line">  <span class="attr">display</span>: <span class="string">&#x27;CSPDarknet53&#x27;</span>,</span><br><span class="line">  <span class="attr">link</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">color</span>: colors.<span class="property">YOLOv4</span>,</span><br><span class="line">  <span class="attr">from</span>: [<span class="string">&#x27;YOLOv4&#x27;</span>],</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p><p>æ³¨æ„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹è¦è‡ªå®šä¹‰<code>x</code>å’Œ<code>y</code>ä¸º0ã€‚</p><h3 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h3><p>è¿è¡Œåæˆ‘ä»¬æ‰“å¼€ç½‘é¡µï¼Œç•Œé¢å³ä¸Šè§’å¯ä»¥è°ƒèŠ‚æš—å¤œæ¨¡å¼ï¼Œé¼ æ ‡ç‚¹å‡»å·¦ä¾§ç©ºç™½æ˜¯å›é€€ï¼Œé¼ æ ‡ç‚¹å‡»å³ä¾§ç©ºç™½æ˜¯å‰è¿›ï¼Œå³ä¸‹è§’æŒ‰é’®å¯ä»¥è¿›å…¥stepæ¨¡å¼å’Œå±•ç¤ºå…¨éƒ¨ã€‚</p><p>è¿™é‡Œé™„ä¸Šæˆ‘åˆ¶ä½œå®Œæˆåçš„é¡µé¢æˆªå›¾ï¼š</p><p><img src="https://images.whff521.top/Screenshot%202025-07-14%20at%2019.41.23.png" alt="yolo map"></p><p>æˆ‘éƒ¨ç½²åˆ°äº†Cloudflareçš„pagesä¸Šäº†ï¼Œæ–¹ä¾¿éšæ—¶æŸ¥çœ‹ã€‚è¿™é‡Œé™„ä¸Š<a href="https://github.com/WHFF521/yak-shaving-map-yolo">æˆ‘ä»“åº“çš„é“¾æ¥</a></p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;antfuçš„è–…ç‰›æ¯›åœ°å›¾çš„è‡ªç”¨æ–¹æ³•&quot;&gt;&lt;a href=&quot;#antfuçš„è–…ç‰›æ¯›åœ°å›¾çš„è‡ªç”¨æ–¹æ³•&quot; class=&quot;headerlink&quot; title=&quot;antfuçš„è–…ç‰›æ¯›åœ°å›¾çš„è‡ªç”¨æ–¹æ³•&quot;&gt;&lt;/a&gt;antfuçš„è–…ç‰›æ¯›åœ°å›¾çš„è‡ªç”¨æ–¹æ³•&lt;/h1&gt;&lt;h2 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a</summary>
        
      
    
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://blog.whff521.xyz/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="yolo" scheme="https://blog.whff521.xyz/tags/yolo/"/>
    
    <category term="è·¯çº¿å›¾" scheme="https://blog.whff521.xyz/tags/%E8%B7%AF%E7%BA%BF%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>Pytorchå’Œcudaç¯å¢ƒå®‰è£…</title>
    <link href="https://blog.whff521.xyz/2025/07/05/Pytorch%E5%92%8Ccuda%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/"/>
    <id>https://blog.whff521.xyz/2025/07/05/Pytorch%E5%92%8Ccuda%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/</id>
    <published>2025-07-05T02:09:36.000Z</published>
    <updated>2025-07-05T02:50:23.217Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Pytorchå’Œcudaç¯å¢ƒå®‰è£…"><a href="#Pytorchå’Œcudaç¯å¢ƒå®‰è£…" class="headerlink" title="Pytorchå’Œcudaç¯å¢ƒå®‰è£…"></a>Pytorchå’Œcudaç¯å¢ƒå®‰è£…</h1><p>ä¸ºäº†é¿å…æ›´æ¢ä¸åŒç‰ˆæœ¬Cudaçš„éº»çƒ¦ï¼Œç¯å¢ƒåœ¨Anacondaé‡Œé¢æ­å»ºã€‚</p><h2 id="åˆ›å»ºcondaç¯å¢ƒ"><a href="#åˆ›å»ºcondaç¯å¢ƒ" class="headerlink" title="åˆ›å»ºcondaç¯å¢ƒ"></a>åˆ›å»ºcondaç¯å¢ƒ</h2><p>Anacondaçš„å®‰è£…å°±ä¸èµ˜è¿°ï¼Œé¦–å…ˆæ˜¯åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda create --name your-env-name python=3.13</span><br></pre></td></tr></table></figure><br><code>your-env-name</code>æ˜¯ç¯å¢ƒåç§°ï¼Œéšæ„æ›´æ¢ï¼Œpythonç‰ˆæœ¬ä¹Ÿå¯æ ¹æ®ä¸åŒç¯å¢ƒè¿›è¡Œæ›´æ”¹ã€‚è¿™é‡Œè¦æ³¨æ„<code>--name</code>æ˜¯ä¸¤ä¸ª<code>-</code>ï¼Œå¦‚æœåªæ‰“ä¸€ä¸ª<code>-</code>ä½ æœ‰æ¦‚ç‡ä¼šè·å¾—ä¸€ä¸ªåå­—å«<code>ame</code>çš„è™šæ‹Ÿç¯å¢ƒğŸ˜‚</p><p>åƒä¸‡ä¸è¦å¿˜äº†è¿›å…¥è™šæ‹Ÿç¯å¢ƒå†è¿›è¡Œä¸‹é¢çš„æ“ä½œï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda activate your-env-name</span><br></pre></td></tr></table></figure></p><h2 id="å®‰è£…Cuda"><a href="#å®‰è£…Cuda" class="headerlink" title="å®‰è£…Cuda"></a>å®‰è£…Cuda</h2><p>è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•ï¼Œç¬¬ä¸€æ˜¯ç”¨condaå‘½ä»¤è¿›è¡Œå®‰è£…ï¼Œæºåº”è¯¥æ˜¯condaä»“åº“ã€‚ç¬¬äºŒç§æ˜¯é€šè¿‡pipï¼Œæºæ˜¯pipçš„ä»“åº“ã€‚å…¶ä¸­condaå®‰è£…çš„å‘½ä»¤è™½ç„¶æ›´ç®€å•ï¼Œä½†æ˜¯condaä»“åº“é‡ŒCudaç‰ˆæœ¬ååˆ†æœ‰é™ï¼Œæ‰€ä»¥å¦‚æœcondaä»“åº“é‡Œå¦‚æœæ²¡æœ‰è‡ªå·±æƒ³è¦çš„ç‰ˆæœ¬è¿˜æ˜¯æ¨èç”¨pipè¿›è¡Œå®‰è£…ã€‚</p><h3 id="é€šè¿‡condaå®‰è£…"><a href="#é€šè¿‡condaå®‰è£…" class="headerlink" title="é€šè¿‡condaå®‰è£…"></a>é€šè¿‡condaå®‰è£…</h3><p>å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹condaä»“åº“ä¸­æœ‰å“ªäº›ç‰ˆæœ¬çš„Cudaï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda search cudatoolkit --info</span><br></pre></td></tr></table></figure><br>é€šè¿‡condaå®‰è£…Cudaçš„å‘½ä»¤ä¸ºï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install cudatoolkit=11.7</span><br></pre></td></tr></table></figure></p><h3 id="é€šè¿‡pipå®‰è£…"><a href="#é€šè¿‡pipå®‰è£…" class="headerlink" title="é€šè¿‡pipå®‰è£…"></a>é€šè¿‡pipå®‰è£…</h3><p><a href="https://docs.nvidia.com/cuda/cuda-quick-start-guide/index.html#pip-wheels-windows">NVIDIA å®˜ç½‘</a>æä¾›äº†é€šè¿‡pipå®‰è£…çš„æ–¹æ³•ã€‚</p><p>å®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ›´æ–°pip</span></span><br><span class="line">py -m pip install --upgrade setuptools pip wheel</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å®‰è£…nvidia-pyindex</span></span><br><span class="line">py -m pip install nvidia-pyindex</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å®‰è£…cuda12</span></span><br><span class="line">py -m pip install nvidia-cuda-runtime-cu12</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯é€‰ å®‰è£…å…¶ä»–æ¨¡å—</span></span><br><span class="line">py -m pip install nvidia-&lt;library&gt;</span><br></pre></td></tr></table></figure><br>å…¶ä¸­<code>py</code>éœ€è¦æ›¿æ¢æˆ<code>python</code>ã€‚</p><h2 id="å®‰è£…Pytorch"><a href="#å®‰è£…Pytorch" class="headerlink" title="å®‰è£…Pytorch"></a>å®‰è£…Pytorch</h2><p><a href="https://pytorch.org/get-started/locally/">Pytorch å®˜ç½‘</a>æä¾›äº†å¯¹åº”çš„å®‰è£…å‘½ä»¤<br><img src="https://images.whff521.top/Screenshot%202025-07-05%20at%2010.35.01.png" alt="å®‰è£…å‘½ä»¤"></p><p>è¿™é‡Œè´´å‡ºæˆ‘ä½¿ç”¨çš„ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118</span><br></pre></td></tr></table></figure></p><h2 id="æ£€éªŒå®‰è£…"><a href="#æ£€éªŒå®‰è£…" class="headerlink" title="æ£€éªŒå®‰è£…"></a>æ£€éªŒå®‰è£…</h2><p>ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥<code>python</code>è¿›å…¥åˆ°pythonï¼Œè¾“å…¥ä»¥ä¸‹å‡ è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="built_in">print</span>(torch.version.cuda)</span><br><span class="line">torch.cuda.is_available()</span><br></pre></td></tr></table></figure><p>æ³¨æ„importä¹‹åä¼šæœ‰ä¸€æ®µæ—¶é—´ç­‰å¾…pythonåŠ è½½ã€‚</p><p>PSï¼šä»Šå¤©ä¹Ÿæ˜¯æˆ‘ç¬¬ä¸€æ¬¡ç”¨anacondaè¿›è¡Œæ­å»ºè¿™ä¸ªç¯å¢ƒï¼Œä»…ä»…æ˜¯æ­å»ºè¿˜æœªæŠ•å…¥åˆ°ä»£ç çš„ä½¿ç”¨ï¼Œå¯èƒ½ä¼šæœ‰é—®é¢˜ã€‚</p><p>PS2ï¼šå°é¢æ˜¯å¤§ç©ºã‚¹ãƒãƒ«ï¼Œä¸¤å¤©å‰æ˜¯å¥¹çš„ç”Ÿæ—¥ï¼ã—ã‚…ã°ã—ã‚…ã°ã—ã‚…ã°ï¼ï¼ï¼ </p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;Pytorchå’Œcudaç¯å¢ƒå®‰è£…&quot;&gt;&lt;a href=&quot;#Pytorchå’Œcudaç¯å¢ƒå®‰è£…&quot; class=&quot;headerlink&quot;</summary>
        
      
    
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://blog.whff521.xyz/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="Pytorch" scheme="https://blog.whff521.xyz/tags/Pytorch/"/>
    
    <category term="Cuda" scheme="https://blog.whff521.xyz/tags/Cuda/"/>
    
  </entry>
  
</feed>
